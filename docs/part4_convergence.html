<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Stochastic Convergence – Probability Theory for Econometricians</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./part3_covariance.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="4&nbsp; Stochastic Convergence – Probability Theory for Econometricians">
<meta property="og:description" content="">
<meta property="og:site_name" content="Probability Theory for Econometricians">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part4_convergence.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Stochastic Convergence</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Probability Theory for Econometricians</a> 
        <div class="sidebar-tools-main">
    <a href="./Probability-Theory-for-Econometricians.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part1_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part2_expectation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Expected Value</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part3_covariance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Random Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part4_convergence.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Stochastic Convergence</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#estimation" id="toc-estimation" class="nav-link active" data-scroll-target="#estimation"><span class="header-section-number">4.1</span> Estimation</a>
  <ul class="collapse">
  <li><a href="#parameters-and-estimators" id="toc-parameters-and-estimators" class="nav-link" data-scroll-target="#parameters-and-estimators"><span class="header-section-number">4.1.1</span> Parameters and Estimators</a></li>
  <li><a href="#sequences-of-random-variables" id="toc-sequences-of-random-variables" class="nav-link" data-scroll-target="#sequences-of-random-variables"><span class="header-section-number">4.1.2</span> Sequences of Random Variables</a></li>
  </ul></li>
  <li><a href="#convergence-in-probability" id="toc-convergence-in-probability" class="nav-link" data-scroll-target="#convergence-in-probability"><span class="header-section-number">4.2</span> Convergence in Probability</a>
  <ul class="collapse">
  <li><a href="#definition-for-general-sequences" id="toc-definition-for-general-sequences" class="nav-link" data-scroll-target="#definition-for-general-sequences"><span class="header-section-number">4.2.1</span> Definition for General Sequences</a></li>
  <li><a href="#consistency-for-a-parameter" id="toc-consistency-for-a-parameter" class="nav-link" data-scroll-target="#consistency-for-a-parameter"><span class="header-section-number">4.2.2</span> Consistency for a Parameter</a></li>
  <li><a href="#sufficient-condition-for-consistency-and-the-mse-decomposition" id="toc-sufficient-condition-for-consistency-and-the-mse-decomposition" class="nav-link" data-scroll-target="#sufficient-condition-for-consistency-and-the-mse-decomposition"><span class="header-section-number">4.2.3</span> Sufficient Condition for Consistency and the MSE Decomposition</a></li>
  <li><a href="#law-of-large-numbers" id="toc-law-of-large-numbers" class="nav-link" data-scroll-target="#law-of-large-numbers"><span class="header-section-number">4.2.4</span> Law of Large Numbers</a></li>
  <li><a href="#rate-of-convergence" id="toc-rate-of-convergence" class="nav-link" data-scroll-target="#rate-of-convergence"><span class="header-section-number">4.2.5</span> Rate of Convergence</a></li>
  </ul></li>
  <li><a href="#convergence-in-distribution" id="toc-convergence-in-distribution" class="nav-link" data-scroll-target="#convergence-in-distribution"><span class="header-section-number">4.3</span> Convergence in Distribution</a>
  <ul class="collapse">
  <li><a href="#limiting-distribution-definition-for-general-sequences" id="toc-limiting-distribution-definition-for-general-sequences" class="nav-link" data-scroll-target="#limiting-distribution-definition-for-general-sequences"><span class="header-section-number">4.3.1</span> Limiting Distribution Definition for General Sequences</a></li>
  <li><a href="#consistent-estimator-has-degenerate-limiting-distribution" id="toc-consistent-estimator-has-degenerate-limiting-distribution" class="nav-link" data-scroll-target="#consistent-estimator-has-degenerate-limiting-distribution"><span class="header-section-number">4.3.2</span> Consistent Estimator Has Degenerate Limiting Distribution</a></li>
  <li><a href="#asymptotic-distribution-of-an-estimator" id="toc-asymptotic-distribution-of-an-estimator" class="nav-link" data-scroll-target="#asymptotic-distribution-of-an-estimator"><span class="header-section-number">4.3.3</span> Asymptotic Distribution of an Estimator</a></li>
  <li><a href="#central-limit-theorem" id="toc-central-limit-theorem" class="nav-link" data-scroll-target="#central-limit-theorem"><span class="header-section-number">4.3.4</span> Central Limit Theorem</a></li>
  <li><a href="#the-normal-distribution-and-its-properties" id="toc-the-normal-distribution-and-its-properties" class="nav-link" data-scroll-target="#the-normal-distribution-and-its-properties"><span class="header-section-number">4.3.5</span> The Normal Distribution and Its Properties</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Stochastic Convergence</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Building on the concepts of the previous sections, we now turn to stochastic convergence which helps us understand the behavior of estimators as sample sizes increase. Stochastic convergence provides the theoretical framework for understanding when and how our estimates approach the true population parameters, which is essential for conducting valid statistical inference in econometric analysis.</p>
<section id="estimation" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="estimation"><span class="header-section-number">4.1</span> Estimation</h2>
<section id="parameters-and-estimators" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="parameters-and-estimators"><span class="header-section-number">4.1.1</span> Parameters and Estimators</h3>
<p>A <strong>parameter</strong> <span class="math inline">\theta</span> is a characteristic or feature of a population distribution. Parameters are typically fixed but unknown quantities that we aim to learn about through sampling and estimation. Examples of parameters include:</p>
<ul>
<li>The mean (expected value) <span class="math inline">\mu</span> of a population distribution</li>
<li>The variance <span class="math inline">\sigma^2</span> of a population distribution</li>
<li>The coefficients <span class="math inline">\boldsymbol{\beta}</span> in a regression model</li>
<li>The correlation <span class="math inline">\rho</span> between two random variables</li>
</ul>
<p>An <strong>estimator</strong> <span class="math inline">\widehat{\theta}</span> is a function of sample data intended to approximate the unknown parameter <span class="math inline">\theta</span>. Since an estimator is a function of random variables (the sample), it is itself a random variable. When we actually compute the estimator from a specific realized sample, we call the resulting value an <strong>estimate</strong>.</p>
<p>For example, the sample mean <span class="math inline">\overline{Y} = \frac{1}{n}\sum_{i=1}^n Y_i</span> is an estimator for the population mean <span class="math inline">\mu = E[Y]</span>.</p>
</section>
<section id="sequences-of-random-variables" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="sequences-of-random-variables"><span class="header-section-number">4.1.2</span> Sequences of Random Variables</h3>
<p>When we consider the properties of estimators, we often examine what happens as the sample size increases. This leads us to study sequences of random variables.</p>
<p>A <strong>sequence of random variables</strong> <span class="math inline">\{W_n\}_{n=1}^{\infty}</span> is an ordered collection of random variables indexed by sample size <span class="math inline">n</span>. For estimators, we are interested in how the sequence <span class="math inline">\{\widehat{\theta}_n\}_{n=1}^{\infty}</span> behaves as <span class="math inline">n</span> increases, where <span class="math inline">\widehat{\theta}_n</span> represents the estimator based on a sample of size <span class="math inline">n</span>.</p>
<p>The behavior of such sequences as <span class="math inline">n \to \infty</span> is the focus of asymptotic theory in econometrics. Understanding this behavior allows us to evaluate the properties of estimators in large samples, even when their exact finite-sample distributions are intractable.</p>
</section>
</section>
<section id="convergence-in-probability" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="convergence-in-probability"><span class="header-section-number">4.2</span> Convergence in Probability</h2>
<section id="definition-for-general-sequences" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="definition-for-general-sequences"><span class="header-section-number">4.2.1</span> Definition for General Sequences</h3>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Convergence in Probability</strong></p>
<p>A sequence of random variables <span class="math inline">\{W_n\}_{n=1}^{\infty}</span> <strong>converges in probability</strong> to a constant <span class="math inline">c</span> if, for any <span class="math inline">\epsilon &gt; 0</span>,</p>
<p><span class="math display">\lim_{n \to \infty} P(|W_n - c| &gt; \epsilon) = 0</span></p>
<p>Equivalently, this can be expressed as:</p>
<p><span class="math display">\lim_{n \to \infty} P(|W_n - c| \leq \epsilon) = 1</span></p>
<p>This is denoted as <span class="math inline">W_n \overset{p}{\to} c</span>.</p>
</div>
<p><br>
</p>
<p>Intuitively, convergence in probability means that as the sample size <span class="math inline">n</span> increases, the probability that <span class="math inline">W_n</span> deviates from <span class="math inline">c</span> by more than any fixed positive amount <span class="math inline">\epsilon</span> becomes arbitrarily small.</p>
<p>For example, if <span class="math inline">W_n \overset{p}{\to} c</span>, then for any small <span class="math inline">\epsilon &gt; 0</span> (say, <span class="math inline">\epsilon = 0.01</span>), we can make <span class="math inline">P(|W_n - c| &gt; 0.01)</span> as small as we want by choosing a sufficiently large sample size <span class="math inline">n</span>.</p>
</section>
<section id="consistency-for-a-parameter" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="consistency-for-a-parameter"><span class="header-section-number">4.2.2</span> Consistency for a Parameter</h3>
<p>Applying the concept of convergence in probability to estimators leads to the important property of <strong>consistency</strong>. Good estimators get closer and closer to the true parameter being estimated as the sample size <span class="math inline">n</span> increases, eventually returning the true parameter value in a hypothetically infinitely large sample.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Consistency</strong></p>
<p>An estimator <span class="math inline">\widehat{\theta}_n</span> is <strong>consistent</strong> for the parameter <span class="math inline">\theta</span> if:</p>
<p><span class="math display">\widehat{\theta}_n \overset{p}{\to} \theta \quad \text{as} \quad n \to \infty</span></p>
<p>That is, if for any <span class="math inline">\epsilon &gt; 0</span>:</p>
<p><span class="math display">\lim_{n \to \infty} P(|\widehat{\theta}_n - \theta| &gt; \epsilon) = 0</span></p>
</div>
<p><br>
</p>
<p>Consistency is a minimal requirement for a good estimator. It ensures that with a large enough sample, the estimator will be arbitrarily close to the true parameter with high probability. However, consistency alone doesn’t tell us how quickly the estimator approaches the parameter as the sample size increases.</p>
<p>If an estimator <span class="math inline">\widehat \theta</span> is a continuous random variable, it will almost never reach exactly the true parameter value because point probabilities are zero: <span class="math inline">P(\widehat \theta = \theta) = 0</span>.</p>
<p>However, the larger the sample size, the higher should be the probability that <span class="math inline">\widehat \theta</span> is close to the true value <span class="math inline">\theta</span>. Consistency means that, if we fix some small precision value <span class="math inline">\epsilon &gt; 0</span>, then, <span class="math display">P(|\widehat \theta - \theta| \leq \epsilon) = P( \theta - \epsilon \leq \widehat \theta \leq \theta + \epsilon)</span> should increase in the sample size <span class="math inline">n</span> and eventually reach 1.</p>
<p>Here’s the improved subsection on sufficient condition and MSE decomposition:</p>
<p>I’ve analyzed your updated version in paste.txt, and I can make the proof more concise by directly substituting the variance and bias. Here’s a revised version that maintains comprehensiveness while being more concise:</p>
</section>
<section id="sufficient-condition-for-consistency-and-the-mse-decomposition" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="sufficient-condition-for-consistency-and-the-mse-decomposition"><span class="header-section-number">4.2.3</span> Sufficient Condition for Consistency and the MSE Decomposition</h3>
<p>A powerful approach to establishing consistency relies on examining the mean squared error (MSE) of an estimator and applying Markov’s inequality.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Markov’s Inequality</strong></p>
<p>For any non-negative random variable <span class="math inline">X</span> and any positive constant <span class="math inline">a</span>:</p>
<p><span class="math display">P(X \geq a) \leq \frac{E[X]}{a}</span></p>
</div>
<p><br>
</p>
<p>Markov’s inequality provides an upper bound on the probability that a non-negative random variable exceeds any positive threshold. While this bound may not be tight, it is extremely useful for proving convergence results.</p>
<p>To apply Markov’s inequality to establish consistency, we consider the squared deviation between the estimator and the parameter:</p>
<p><span class="math display">\begin{align*}
P(|\widehat{\theta}_n - \theta| &gt; \epsilon) &amp;= P((\widehat{\theta}_n - \theta)^2 &gt; \epsilon^2) \\
&amp;\leq \frac{E[(\widehat{\theta}_n - \theta)^2]}{\epsilon^2} \\
&amp;= \frac{MSE(\widehat{\theta}_n)}{\epsilon^2}
\end{align*}</span></p>
<p>This derivation leads directly to a sufficient condition for consistency:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Sufficient Condition for Consistency</strong></p>
<p>Let <span class="math inline">\widehat{\theta}_n</span> be an estimator for parameter <span class="math inline">\theta</span>. If:</p>
<p><span class="math display">\lim_{n \to \infty} MSE(\widehat{\theta}_n) = \lim_{n \to \infty} E[(\widehat{\theta}_n - \theta)^2] = 0</span></p>
<p>Then <span class="math inline">\widehat{\theta}_n</span> is consistent for <span class="math inline">\theta</span>.</p>
</div>
<p><br>
</p>
<p>To analyze when this condition holds, we need to understand the components of the MSE. The <strong>bias</strong> of an estimator is defined as:</p>
<p><span class="math display">Bias(\widehat{\theta}_n) = E[\widehat{\theta}_n] - \theta</span></p>
<p>The bias measures the systematic deviation of the estimator from the true parameter. An estimator is <strong>unbiased</strong> if <span class="math inline">Bias(\widehat{\theta}_n) = 0</span> for all sample sizes, and <strong>asymptotically unbiased</strong> if <span class="math inline">\lim_{n \to \infty} Bias(\widehat{\theta}_n) = 0</span>.</p>
<p>The MSE can be decomposed into the sum of the variance and the squared bias. Here’s a concise proof:</p>
<p><span class="math display">\begin{align*}
MSE(\widehat{\theta}_n) &amp;= E[(\widehat{\theta}_n - \theta)^2] \\
&amp;= E[(\widehat{\theta}_n - E[\widehat{\theta}_n] + E[\widehat{\theta}_n] - \theta)^2] \\
&amp;= E[(\widehat{\theta}_n - E[\widehat{\theta}_n])^2 + 2(\widehat{\theta}_n - E[\widehat{\theta}_n])(E[\widehat{\theta}_n] - \theta) + (E[\widehat{\theta}_n] - \theta)^2] \\
&amp;= Var(\widehat{\theta}_n) + 2 \cdot 0 \cdot Bias(\widehat{\theta}_n) + [Bias(\widehat{\theta}_n)]^2 \\
&amp;= Var(\widehat{\theta}_n) + [Bias(\widehat{\theta}_n)]^2
\end{align*}</span></p>
<p>The middle term vanishes because <span class="math inline">E[\widehat{\theta}_n - E[\widehat{\theta}_n]] = 0</span> by definition.</p>
<p>This fundamental decomposition reveals that estimation error comes from two sources: the variability of the estimator around its expected value (variance) and the systematic deviation of the expected value from the true parameter (bias).</p>
<p>This leads to a practical sufficient condition for consistency:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Practical Sufficient Condition for Consistency</strong></p>
<p>An estimator <span class="math inline">\widehat{\theta}_n</span> is consistent for <span class="math inline">\theta</span> if both of the following conditions hold as <span class="math inline">n \to \infty</span>:</p>
<ol type="1">
<li><span class="math inline">Bias(\widehat{\theta}_n) \to 0</span> (asymptotically unbiased)</li>
<li><span class="math inline">Var(\widehat{\theta}_n) \to 0</span> (variance approaches zero)</li>
</ol>
</div>
<p><br>
</p>
</section>
<section id="law-of-large-numbers" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="law-of-large-numbers"><span class="header-section-number">4.2.4</span> Law of Large Numbers</h3>
<p>The <strong>Law of Large Numbers (LLN)</strong> is one of the fundamental results in probability theory and provides a key tool for establishing consistency of many estimators.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Weak Law of Large Numbers (WLLN)</strong></p>
<p>Let <span class="math inline">\{Y_1, Y_2, \ldots, Y_n\}</span> be a sequence of independent and identically distributed (i.i.d.) random variables with <span class="math inline">E[Y_i] = \mu</span> and <span class="math inline">Var(Y_i) = \sigma^2 &lt; \infty</span>. Then the sample mean converges in probability to the population mean:</p>
<p><span class="math display">\overline{Y}_n = \frac{1}{n}\sum_{i=1}^n Y_i \overset{p}{\to} \mu \quad \text{as} \quad n \to \infty</span></p>
</div>
<p><br>
</p>
<p>The WLLN essentially states that if we take a large enough sample from a population with finite mean, the sample mean will be close to the population mean with high probability.</p>
<p>For the sample mean, we can directly verify the conditions for consistency:</p>
<ol type="1">
<li><span class="math inline">E[\overline{Y}_n] = \mu</span> (unbiased for all <span class="math inline">n</span>)</li>
<li><span class="math inline">Var(\overline{Y}_n) = \frac{\sigma^2}{n} \to 0</span> as <span class="math inline">n \to \infty</span></li>
</ol>
<p>The LLN extends to functions of sample means as well. If <span class="math inline">g(\cdot)</span> is a continuous function and <span class="math inline">\overline{Y}_n \overset{p}{\to} \mu</span>, then:</p>
<p><span class="math display">g(\overline{Y}_n) \overset{p}{\to} g(\mu)</span></p>
<p>This result, known as the <strong>continuous mapping theorem</strong>, allows us to establish consistency for a wide range of estimators that can be expressed as functions of sample means.</p>
</section>
<section id="rate-of-convergence" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="rate-of-convergence"><span class="header-section-number">4.2.5</span> Rate of Convergence</h3>
<p>While consistency tells us that an estimator eventually converges to the true parameter, it doesn’t indicate how quickly this convergence occurs. The <strong>rate of convergence</strong> provides this information.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Rate of Convergence</strong></p>
<p>A consistent estimator <span class="math inline">\widehat{\theta}_n</span> converges at rate <span class="math inline">r_n</span> if:</p>
<p><span class="math display">r_n(\widehat{\theta}_n - \theta) = O_p(1)</span></p>
<p>where <span class="math inline">O_p(1)</span> indicates that the sequence is “bounded in probability.”</p>
</div>
<p><br>
</p>
<p>For many standard estimators, including the sample mean of i.i.d. random variables, the rate of convergence is <span class="math inline">r_n = \sqrt{n}</span>. This means:</p>
<p><span class="math display">\sqrt{n}(\widehat{\theta}_n - \theta) = O_p(1)</span></p>
<p>The rate of convergence <span class="math inline">r_n = \sqrt{n}</span> is often called the “root-n” rate or “parametric” rate of convergence. Estimators with this rate have the property that to halve the average estimation error, we need to quadruple the sample size.</p>
<p>The root mean squared error (RMSE) captures this relationship:</p>
<p><span class="math display">RMSE(\widehat{\theta}_n) = \sqrt{E[(\widehat{\theta}_n - \theta)^2]} \approx \frac{C}{\sqrt{n}}</span></p>
<p>where <span class="math inline">C</span> is a constant that depends on the specific distribution and estimator.</p>
</section>
</section>
<section id="convergence-in-distribution" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="convergence-in-distribution"><span class="header-section-number">4.3</span> Convergence in Distribution</h2>
<p>While convergence in probability describes how an estimator concentrates around the true parameter, <strong>convergence in distribution</strong> describes the limiting shape of the distribution of the estimator (or a transformation of it).</p>
<section id="limiting-distribution-definition-for-general-sequences" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="limiting-distribution-definition-for-general-sequences"><span class="header-section-number">4.3.1</span> Limiting Distribution Definition for General Sequences</h3>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Convergence in Distribution</strong></p>
<p>A sequence of random variables <span class="math inline">\{W_n\}_{n=1}^{\infty}</span> <strong>converges in distribution</strong> to a random variable <span class="math inline">W</span> if:</p>
<p><span class="math display">\lim_{n \to \infty} F_{W_n}(x) = F_W(x)</span></p>
<p>for all points <span class="math inline">x</span> where <span class="math inline">F_W(x)</span> is continuous. Here, <span class="math inline">F_{W_n}</span> and <span class="math inline">F_W</span> are the cumulative distribution functions of <span class="math inline">W_n</span> and <span class="math inline">W</span>, respectively.</p>
<p>This is denoted as <span class="math inline">W_n \overset{d}{\to} W</span>.</p>
</div>
<p><br>
</p>
<p>Unlike convergence in probability, which relates a sequence of random variables to a fixed constant, convergence in distribution relates the sequence to another random variable with a specific distribution.</p>
<p>It’s important to note that <span class="math inline">W_n \overset{d}{\to} W</span> does not mean that the random variables <span class="math inline">W_n</span> approach <span class="math inline">W</span> in a pointwise sense. Rather, the distribution function of <span class="math inline">W_n</span> approaches the distribution function of <span class="math inline">W</span>.</p>
</section>
<section id="consistent-estimator-has-degenerate-limiting-distribution" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="consistent-estimator-has-degenerate-limiting-distribution"><span class="header-section-number">4.3.2</span> Consistent Estimator Has Degenerate Limiting Distribution</h3>
<p>If an estimator <span class="math inline">\widehat{\theta}_n</span> is consistent for <span class="math inline">\theta</span>, then:</p>
<p><span class="math display">\widehat{\theta}_n \overset{p}{\to} \theta</span></p>
<p>This implies that <span class="math inline">\widehat{\theta}_n</span> also converges in distribution to the constant <span class="math inline">\theta</span>:</p>
<p><span class="math display">\widehat{\theta}_n \overset{d}{\to} \theta</span></p>
<p>However, this limiting distribution is <strong>degenerate</strong> — it places all probability mass at the single point <span class="math inline">\theta</span>. While this confirms consistency, it doesn’t provide information about the shape of the sampling distribution for finite <span class="math inline">n</span>.</p>
</section>
<section id="asymptotic-distribution-of-an-estimator" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="asymptotic-distribution-of-an-estimator"><span class="header-section-number">4.3.3</span> Asymptotic Distribution of an Estimator</h3>
<p>To obtain a non-degenerate limiting distribution that provides useful information about the sampling variability of a consistent estimator, we typically examine a standardized version of the estimator.</p>
<p>If <span class="math inline">\widehat{\theta}_n</span> converges to <span class="math inline">\theta</span> at rate <span class="math inline">r_n</span>, then we study:</p>
<p><span class="math display">r_n(\widehat{\theta}_n - \theta)</span></p>
<p>For many estimators with <span class="math inline">r_n = \sqrt{n}</span>, this standardized quantity converges in distribution to a normal random variable:</p>
<p><span class="math display">\sqrt{n}(\widehat{\theta}_n - \theta) \overset{d}{\to} N(0, V)</span></p>
<p>where <span class="math inline">V</span> is the asymptotic variance.</p>
<p>The distribution of <span class="math inline">\sqrt{n}(\widehat{\theta}_n - \theta)</span> is called the <strong>asymptotic distribution</strong> of the estimator <span class="math inline">\widehat{\theta}_n</span>. For large <span class="math inline">n</span>, we can approximate:</p>
<p><span class="math display">\widehat{\theta}_n \approx N\left(\theta, \frac{V}{n}\right)</span></p>
<p>This approximation is the basis for constructing confidence intervals and conducting hypothesis tests in large samples.</p>
</section>
<section id="central-limit-theorem" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="central-limit-theorem"><span class="header-section-number">4.3.4</span> Central Limit Theorem</h3>
<p>The <strong>Central Limit Theorem (CLT)</strong> is the key result that establishes the asymptotic normality of many estimators.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Central Limit Theorem (CLT)</strong></p>
<p>Let <span class="math inline">\{Y_1, Y_2, \ldots, Y_n\}</span> be a sequence of i.i.d. random variables with mean <span class="math inline">\mu</span> and variance <span class="math inline">\sigma^2 &lt; \infty</span>. Then:</p>
<p><span class="math display">\sqrt{n}(\overline{Y}_n - \mu) \overset{d}{\to} N(0, \sigma^2)</span></p>
<p>Or equivalently:</p>
<p><span class="math display">\frac{\overline{Y}_n - \mu}{\sigma/\sqrt{n}} \overset{d}{\to} N(0, 1)</span></p>
</div>
<p><br>
</p>
<p>The CLT tells us that the standardized sample mean follows a standard normal distribution in large samples, regardless of the underlying distribution of the individual observations (as long as the variance is finite).</p>
<p>This remarkable result means that we can construct approximate confidence intervals and conduct hypothesis tests for the mean using the normal distribution, even when the population distribution is non-normal, provided the sample size is sufficiently large.</p>
<p>The CLT extends to more complex estimators as well. If an estimator can be expressed as a function of sample means, the <strong>delta method</strong> allows us to derive its asymptotic distribution.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Delta Method</strong></p>
<p>If <span class="math inline">\sqrt{n}(\widehat{\theta}_n - \theta) \overset{d}{\to} N(0, V)</span> and <span class="math inline">g(\cdot)</span> is a differentiable function with <span class="math inline">g'(\theta) \neq 0</span>, then:</p>
<p><span class="math display">\sqrt{n}(g(\widehat{\theta}_n) - g(\theta)) \overset{d}{\to} N(0, [g'(\theta)]^2 V)</span></p>
</div>
<p><br>
</p>
</section>
<section id="the-normal-distribution-and-its-properties" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="the-normal-distribution-and-its-properties"><span class="header-section-number">4.3.5</span> The Normal Distribution and Its Properties</h3>
<p>Given the central role of the normal distribution in asymptotic theory, it’s worthwhile to review its key properties.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Normal Distribution</strong></p>
<p>A random variable <span class="math inline">X</span> follows a normal distribution with mean <span class="math inline">\mu</span> and variance <span class="math inline">\sigma^2</span>, denoted <span class="math inline">X \sim N(\mu, \sigma^2)</span>, if its probability density function (PDF) is:</p>
<p><span class="math display">f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)</span></p>
<p>The standard normal distribution, denoted <span class="math inline">Z \sim N(0, 1)</span>, has mean 0 and variance 1, with PDF:</p>
<p><span class="math display">\phi(z) = \frac{1}{\sqrt{2\pi}} \exp\left(-\frac{z^2}{2}\right)</span></p>
<p>and cumulative distribution function (CDF) <span class="math inline">\Phi(z)</span>.</p>
</div>
<p><br>
</p>
<p>Key properties of the normal distribution relevant to econometrics include:</p>
<ol type="1">
<li><p><strong>Linear combinations</strong>: If <span class="math inline">X_1 \sim N(\mu_1, \sigma_1^2)</span> and <span class="math inline">X_2 \sim N(\mu_2, \sigma_2^2)</span> are independent, then: <span class="math display">a X_1 + b X_2 \sim N(a\mu_1 + b\mu_2, a^2\sigma_1^2 + b^2\sigma_2^2)</span></p></li>
<li><p><strong>Standardization</strong>: If <span class="math inline">X \sim N(\mu, \sigma^2)</span>, then: <span class="math display">Z = \frac{X - \mu}{\sigma} \sim N(0, 1)</span></p></li>
<li><p><strong>Symmetry</strong>: The standard normal distribution is symmetric around zero: <span class="math display">\phi(z) = \phi(-z)</span> <span class="math display">\Phi(z) = 1 - \Phi(-z)</span></p></li>
<li><p><strong>Quantiles</strong>: The <span class="math inline">p</span>-quantile of the standard normal distribution, denoted <span class="math inline">z_p</span>, satisfies <span class="math inline">\Phi(z_p) = p</span>. Some important quantiles include:</p>
<ul>
<li><span class="math inline">z_{0.975} = 1.96</span> (used for 95% confidence intervals)</li>
<li><span class="math inline">z_{0.995} = 2.58</span> (used for 99% confidence intervals)</li>
<li><span class="math inline">z_{0.9} = 1.28</span> (used for 90% confidence intervals)</li>
</ul></li>
<li><p><strong>Multivariate normal distribution</strong>: A random vector <span class="math inline">\mathbf{X} = (X_1, X_2, \ldots, X_k)'</span> follows a multivariate normal distribution, denoted <span class="math inline">\mathbf{X} \sim N(\boldsymbol{\mu}, \boldsymbol{\Sigma})</span>, if every linear combination of its components follows a univariate normal distribution.</p></li>
</ol>
<p>The pervasiveness of the normal distribution in asymptotic theory stems from the CLT and related results. Even when the exact finite-sample distribution of an estimator is complex or unknown, its asymptotic normal distribution often provides a good approximation in large samples.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./part3_covariance.html" class="pagination-link" aria-label="Multiple Random Variables">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Random Variables</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>