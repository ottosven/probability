<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>2&nbsp; Probability – Probability Theory for Econometricians</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sec03_dependence.html" rel="next">
<link href="./part1_distribution.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="2&nbsp; Probability – Probability Theory for Econometricians">
<meta property="og:description" content="">
<meta property="og:site_name" content="Probability Theory for Econometricians">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sec02_probability.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Probability Theory for Econometricians</a> 
        <div class="sidebar-tools-main">
    <a href="./Probability-Theory-for-Econometricians.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part1_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec02_probability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec03_dependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dependence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat1_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat3_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat4_expectation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Expectated value</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat5_conditional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Conditional expectation</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#random-experiments" id="toc-random-experiments" class="nav-link active" data-scroll-target="#random-experiments"><span class="header-section-number">2.1</span> Random experiments</a></li>
  <li><a href="#random-variables" id="toc-random-variables" class="nav-link" data-scroll-target="#random-variables"><span class="header-section-number">2.2</span> Random variables</a></li>
  <li><a href="#probability-function" id="toc-probability-function" class="nav-link" data-scroll-target="#probability-function"><span class="header-section-number">2.3</span> Probability function</a></li>
  <li><a href="#distribution" id="toc-distribution" class="nav-link" data-scroll-target="#distribution"><span class="header-section-number">2.4</span> Distribution</a></li>
  <li><a href="#cumulative-distribution-function" id="toc-cumulative-distribution-function" class="nav-link" data-scroll-target="#cumulative-distribution-function"><span class="header-section-number">2.5</span> Cumulative distribution function</a></li>
  <li><a href="#probability-density-function" id="toc-probability-density-function" class="nav-link" data-scroll-target="#probability-density-function"><span class="header-section-number">2.6</span> Probability density function</a></li>
  <li>
<a href="#expected-value" id="toc-expected-value" class="nav-link" data-scroll-target="#expected-value"><span class="header-section-number">2.7</span> Expected value</a>
  <ul class="collapse">
<li><a href="#expectation-of-a-discrete-random-variable" id="toc-expectation-of-a-discrete-random-variable" class="nav-link" data-scroll-target="#expectation-of-a-discrete-random-variable"><span class="header-section-number">2.7.1</span> Expectation of a discrete random variable</a></li>
  <li><a href="#expectation-of-a-continuous-random-variable" id="toc-expectation-of-a-continuous-random-variable" class="nav-link" data-scroll-target="#expectation-of-a-continuous-random-variable"><span class="header-section-number">2.7.2</span> Expectation of a continuous random variable</a></li>
  <li><a href="#sec-unifiedexpectation" id="toc-sec-unifiedexpectation" class="nav-link" data-scroll-target="#sec-unifiedexpectation"><span class="header-section-number">2.7.3</span> Expectation for general random variables</a></li>
  <li><a href="#properties-of-the-expected-value" id="toc-properties-of-the-expected-value" class="nav-link" data-scroll-target="#properties-of-the-expected-value"><span class="header-section-number">2.7.4</span> Properties of the expected value</a></li>
  </ul>
</li>
  <li>
<a href="#descriptive-features-of-a-distribution" id="toc-descriptive-features-of-a-distribution" class="nav-link" data-scroll-target="#descriptive-features-of-a-distribution"><span class="header-section-number">2.8</span> Descriptive features of a distribution</a>
  <ul class="collapse">
<li><a href="#heavy-tailed-distributions" id="toc-heavy-tailed-distributions" class="nav-link" data-scroll-target="#heavy-tailed-distributions"><span class="header-section-number">2.8.1</span> Heavy-tailed distributions</a></li>
  </ul>
</li>
  <li><a href="#the-normal-distribution" id="toc-the-normal-distribution" class="nav-link" data-scroll-target="#the-normal-distribution"><span class="header-section-number">2.9</span> The normal distribution</a></li>
  <li><a href="#additional-reading" id="toc-additional-reading" class="nav-link" data-scroll-target="#additional-reading"><span class="header-section-number">2.10</span> Additional reading</a></li>
  <li><a href="#r-codes" id="toc-r-codes" class="nav-link" data-scroll-target="#r-codes"><span class="header-section-number">2.11</span> R-codes</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><a href="https://statistics.svenotto.com/section2_probability.pdf">PDF version</a></p>
<section id="random-experiments" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="random-experiments">
<span class="header-section-number">2.1</span> Random experiments</h2>
<p>A random experiment is a procedure or situation where the result is uncertain and determined by a probabilistic mechanism. An <strong>outcome</strong> is a specific result of a random experiment. The <strong>sample space</strong> <span class="math inline">S</span> is the set/collection of all potential outcomes.</p>
<p>Let’s consider some examples:</p>
<ul>
<li><p><em>Coin toss</em>: The outcome of a coin toss can be ‘heads’ or ‘tails’. This random experiment has a two-element sample space: <span class="math inline">S = \{heads, tails\}</span>.</p></li>
<li><p><em>Gender</em>: If you conduct a survey and interview a random person to ask them about their gender, the answer may be ‘female’, ‘male’, or ‘diverse’. It is a random experiment since the person to be interviewed is selected randomly. The sample space has three elements: <span class="math inline">S = \{female, male, diverse\}</span>.</p></li>
<li><p><em>Education level</em>: If you ask a random person about their education level according to the <a href="https://en.wikipedia.org/wiki/International_Standard_Classification_of_Education">ISCED-2011 framework</a>, the outcome may be one of the eight ISCED-2011 levels. We have an eight-element sample space: <span class="math display">S = \{Level \ 1, Level \ 2, Level \ 3, Level \ 4, Level \ 5, Level \ 6, Level \ 7, Level \ 8\}.</span></p></li>
<li><p><em>Wage</em>: If you ask a random person about their income per working hour in EUR, there are infinitely many potential answers. Any (non-negative) real number may be an outcome. The sample space is a continuum of different wage levels.</p></li>
</ul></section><section id="random-variables" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="random-variables">
<span class="header-section-number">2.2</span> Random variables</h2>
<p>A <strong>random variable</strong> is a numerical summary of a random experiment. In econometrics and applied statistics, we always express random experiments in terms of random variables. Let’s define some random variables based on the random experiments above:</p>
<ul>
<li>
<em>Coin</em>: A two-element sample space random experiment can be transformed to a binary random variable, i.e., a random variable that takes either 0 or 1. We define the <em>coin</em> random variable as <span class="math display">
Y = \begin{cases}
1   &amp; \text{if outcome is heads,} \\
0   &amp; \text{if outcome is tails.}
\end{cases}
</span> A binary random variable is also called <strong>Bernoulli random variable</strong>.</li>
</ul>
<div id="fig-educationprobabilities" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-educationprobabilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex1transf.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-educationprobabilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Bernoulli random variable
</figcaption></figure>
</div>
<ul>
<li><p><em>Female dummy</em>: The three-element sample space of the gender random experiment does not provide any natural ordering. A useful way to transform it into random variables are <strong>dummy variables</strong>. The <em>female</em> dummy variable is a Bernoulli random variable with <span class="math display">
Y = \begin{cases}
1   &amp; \text{if the person is female,} \\
0   &amp; \text{if the person is not female.}
\end{cases}
</span> Similarly, dummy variables for <em>male</em> and <em>diverse</em> can be defined.</p></li>
<li><p><em>Education</em>: The eight-element sample space of the education-level random experiment provides a natural ordering. We define the random variable <em>education</em> as the number of years of schooling of the interviewed person: <span class="math display">
Y = \text{number of years of schooling} \in \{4, 10, 12, 13, 14, 16, 18, 21\}.
</span></p></li>
</ul>
<div class="cell" data-layout-align="center">
<div id="tbl-ISCED" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ISCED-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.1: ISCED 2011 levels
</figcaption><div aria-describedby="tbl-ISCED-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">ISCED level</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Education level</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Years of schooling</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">Primary</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">Lower Secondary</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">Upper secondary</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">Post-Secondary</td>
<td style="text-align: center;">13</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">Short-Cycle Tertiary</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">Bachelor's</td>
<td style="text-align: center;">16</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">Master's</td>
<td style="text-align: center;">18</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">Doctoral</td>
<td style="text-align: center;">21</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<ul>
<li>
<em>Wage</em>: The wage level of the interviewed is already numerical. The random variable is <span class="math display">
Y = \text{income per working hour in EUR}.
</span>
</li>
</ul></section><section id="probability-function" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="probability-function">
<span class="header-section-number">2.3</span> Probability function</h2>
<p>In the case of a fair coin, it is natural to assign the following probabilities to the coin variable: <span class="math inline">P(Y = 0) = 0.5</span> and <span class="math inline">P(Y = 1) = 0.5</span>. By definition, the coin variable will never take the value 2.5, so the corresponding probability is <span class="math inline">P(Y=2.5) = 0</span>. We may also consider intervals, e.g., <span class="math inline">P(Y \geq 0) = 1</span> and <span class="math inline">P(-1 \leq Y &lt; 1) = 0.5</span></p>
<p>The <strong>probability function</strong> <span class="math inline">P</span> assigns values between 0 and 1 to <strong>events</strong>. Specific subsets of the real line define events. Any real number defines an event, and any open, half-open, or closed interval represents an event as well, e.g., <span class="math display">
  A_1 = \{Y=0\}, \quad A_2 = \{Y=1\}, \quad A_3 = \{Y=2.5\}
</span> and <span class="math display">
  A_4 = \{Y \geq 0\}, \quad A_5 = \{ -1 \leq Y &lt; 1 \}.
</span> We may take <strong>complements</strong> <span class="math display">
  A_6 := A_4^c = \{Y \geq 0\}^c = \{ Y &lt; 0\},
</span> as well as <strong>unions</strong> and <strong>intersections</strong>: <span class="math display">\begin{align*}
A_7 &amp;:= A_1 \cup A_6 = \{Y=0\} \cup \{Y&lt; 0\} = \{Y \leq 0\}, \\
A_8 &amp;:= A_4 \cap A_5 = \{Y \geq 0\} \cap \{ -1 \leq Y &lt; 1 \} = \{ 0 \leq Y &lt; 1 \}.
\end{align*}</span> Unions and intersections can also applied iteratively, <span class="math display">
  A_9 := A_1 \cup A_2 \cup A_3 \cup A_5 \cup A_6 \cup A_7 \cup A_8 = \{ Y \in (-\infty, 1] \cup \{2.5\}\},
</span> and by taking complements, we obtain the full real line and the empty set: <span class="math display">\begin{align*}
A_{10} &amp;:= A_9 \cup A_9^c = \{Y \in \mathbb R\}, \\
A_{11} &amp;:= A_{10}^c = \{\}.
\end{align*}</span> You may verify that <span class="math inline">P(A_1) = 0.5</span>, <span class="math inline">P(A_2) = 0.5</span>, <span class="math inline">P(A_3) = 0</span>, <span class="math inline">P(A_4) = 1</span> <span class="math inline">P(A_5) = 0.5</span>, <span class="math inline">P(A_6) = 0</span>, <span class="math inline">P(A_7) = 0.5</span>, <span class="math inline">P(A_8) = 0.5</span>, <span class="math inline">P(A_9) = 1</span>, <span class="math inline">P(A_{10}) = 1</span>, <span class="math inline">P(A_{11}) = 0</span>. If you take the variables <em>education</em> or <em>wage</em>, the probabilities of these events may be completely different.</p>
<p>To make probabilities a mathematically sound concept, we have to define to which events probabilities are assigned and how these probabilities are assigned. We consider the concept of a <strong>sigma algebra</strong> to collect all events.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Sigma algebra</strong></p>
<p>A collection <span class="math inline">\mathcal B</span> of sets is called <span style="color:orange">sigma algebra</span> if it satisfies the following three properties:</p>
<ol type="1">
<li><p><span class="math inline">\{\} \in \mathcal B</span> &nbsp;(empty set)</p></li>
<li><p>If <span class="math inline">A \in \mathcal B</span> then <span class="math inline">A^c \in \mathcal B</span></p></li>
<li><p>If <span class="math inline">A_1, A_2, \ldots \in \mathcal B</span>, then <span class="math inline">A_1 \cup A_2 \cup \ldots \in \mathcal B</span>.</p></li>
</ol>
</div>
<p><br></p>
<p>If you take all events of the form <span class="math inline">\{ Y \in (a,b) \}</span>, where <span class="math inline">a, b \in \mathbb R \cup \{-\infty, \infty\}</span>, and if you add all unions, intersections, and complements of these events, and again all unions, intersections, and complements of those events, and so on, you will obtain the so-called <strong>Borel sigma algebra</strong>. The Borel sigma algebra contains all events we assign probabilities to, the <strong>Borel sets</strong>.</p>
<p>Probabilities must follow certain conditions. The following axioms ensure that these conditions are fulfilled:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Probability function</strong></p>
<p>A probability function <span class="math inline">P</span> is a function <span class="math inline">P: \mathcal B \to [0,1]</span> that satisfies the <span style="color:orange">Axioms of Probability</span>:</p>
<ol type="1">
<li><p><span class="math inline">P(A) \geq 0</span> for every <span class="math inline">A \in \mathcal B</span></p></li>
<li><p><span class="math inline">P(Y \in \mathbb R) = 1</span></p></li>
<li><p>If <span class="math inline">A_1, A_2, A_3 \ldots</span> are disjoint then <span class="math display">A_1 \cup A_2 \cup A_3 \cup \ldots = P(A_1) + P(A_2) + P(A_3) + \ldots</span></p></li>
</ol>
</div>
<p><br></p>
<p>Recall that two events <span class="math inline">A</span> and <span class="math inline">B</span> are <strong>disjoint</strong> if they have no outcomes in common, i.e., if <span class="math inline">A \cap B = \{\}</span>. For instance, <span class="math inline">A_1</span> and <span class="math inline">A_2</span> are <span class="math inline">A_1 = \{Y=0\}</span> and <span class="math inline">A_2 = \{Y=1\}</span> are disjoint, but <span class="math inline">A_1</span> and <span class="math inline">A_4 = \{Y \geq 0\}</span> are not disjoint, since <span class="math inline">A_1 \cap A_4 = \{Y=0\}</span> is nonempty.</p>
<p>Probabilities are a well-defined concept if we use the Borel sigma algebra and the axioms of probability. The mathematical details are developed in the field of measure theory.</p>
<p>The axioms of probability imply the following rules of calculation:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Basic rules of probability</strong></p>
<ul>
<li>
<span class="math inline">0 \leq P(A) \leq 1</span> &nbsp;for any event <span class="math inline">A</span>
</li>
<li>
<span class="math inline">P(A^c) = 1 - P(A)</span> &nbsp;for the complement event of <span class="math inline">A</span>
</li>
<li>
<span class="math inline">P(A \cup B) = P(A) + P(B) - P(A \cap B)</span> &nbsp;for any events <span class="math inline">A, B</span> (inclusion-exclusion principle)</li>
<li>
<span class="math inline">P(A) \leq P(B)</span> &nbsp;if <span class="math inline">A \subset B</span>
</li>
<li>
<span class="math inline">P(A \cup B) = P(A) + P(B)</span> &nbsp;if <span class="math inline">A</span> and <span class="math inline">B</span> are disjoint</li>
</ul>
</div>
<p><br></p>
</section><section id="distribution" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="distribution">
<span class="header-section-number">2.4</span> Distribution</h2>
<p>The <strong>distribution</strong> of a random variable <span class="math inline">Y</span> is characterized by the probabilities of all events of <span class="math inline">Y</span> in the Borel sigma algebra. The distribution of the <em>coin</em> variable is fully characterized by the probabilities <span class="math inline">P(Y=1) = 0.5</span> and <span class="math inline">P(Y=0) = 0.5</span>. We can compute the probabilities of all other events using the basic rules of probability. The probability mass function summarizes these probabilities:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Probability mass function (PMF)</strong></p>
<p>The probability mass function (PMF) of a random variable <span class="math inline">Y</span> is <span class="math display">
  \pi(a) := P(Y = a), \quad a \in \mathbb R
</span></p>
</div>
<p><br></p>
<p>The PMF of the <em>coin</em> variable is <span class="math display">
  \pi(a) = P(Y=a) = \begin{cases} 0.5 &amp; \text{if} \ a \in\{0,1\}, \\
  0 &amp; \text{otherwise}. \end{cases}
</span> The <em>education</em> variable may have the following PMF: <span class="math display">
        \pi(a) = P(Y=a) = \begin{cases}
        0.008 &amp; \text{if} \ a = 4 \\
        0.048 &amp; \text{if} \ a = 10 \\
        0.392 &amp; \text{if} \ a = 12 \\
        0.072 &amp; \text{if} \ a = 13 \\
        0.155 &amp; \text{if} \ a = 14 \\
        0.071 &amp; \text{if} \ a = 16 \\
        0.225 &amp; \text{if} \ a = 18 \\
        0.029 &amp; \text{if} \ a = 21 \\
        0   &amp; \text{otherwise}
        \end{cases}
  </span></p>
<p>The PMF is useful for distributions where the sum of the PMF values over a discrete (finite or countably infinite) number of domain points equals 1, as in the examples above. These distributions are called <strong>discrete distributions</strong>.</p>
<p>Another example of a discrete distribution is the <strong>Poisson distribution</strong> with parameter <span class="math inline">\lambda &gt; 0</span>, which has the PMF <span class="math display">
  \pi(a) = \begin{cases} \frac{e^{-\lambda} \lambda^a}{a!} &amp; \text{if} \ a = 0, 1,2,3, \ldots \\
  0 &amp; \text{otherwise.} \end{cases}
</span> It has a countably infinite number of domain points with nonzero PMF values, and its probabilities sum to 1, i.e., <span class="math inline">\sum_{a=0}^\infty \pi(a) = e^{-\lambda} \sum_{a=0}^\infty \frac{\lambda^a}{a!} = 1</span> since the exponential function has the power series representation <span class="math inline">e^\lambda = \sum_{a=0}^\infty \frac{\lambda^a}{a!}</span>.</p>
<p>Not all random variables are discrete, e.g., the <em>wage</em> variable takes values on a continuum. The cumulative distribution function is a unifying concept summarizing the distribution of any random variable.</p>
</section><section id="cumulative-distribution-function" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="cumulative-distribution-function">
<span class="header-section-number">2.5</span> Cumulative distribution function</h2>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Cumulative distribution function (CDF)</strong></p>
<p>The cumulative distribution function (CDF) of a random variable <span class="math inline">Y</span> is <span class="math display">
  F(a) := P(Y \leq a), \quad a \in \mathbb R,
</span></p>
</div>
<p><br></p>
<p>The CDF of the variable <em>coin</em> is <span class="math display">
        F(a) = \begin{cases} 0 &amp; a &lt; 0, \\
        0.5 &amp; 0 \leq a &lt; 1, \\
        1 &amp; a \geq 1, \end{cases}
    </span> with the following CDF plot:</p>
<div id="fig-CDFcoin" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFcoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex1CDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFcoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: CDF of coin
</figcaption></figure>
</div>
<p>The CDF of the variables <em>education</em> is</p>
<div id="fig-CDFedu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex3CDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: CDF of education
</figcaption></figure>
</div>
<p>and the CDF of the variable <em>wage</em> may have the following form:</p>
<div id="fig-CDFwage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4CDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.4: CDF of wage
</figcaption></figure>
</div>
<p>By the basic rules of probability, we can compute the probability of any event if we know the probabilities of all events of the form <span class="math inline">\{Y \leq a\}</span>.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>Some basic rules for the CDF (for <span class="math inline">a &lt; b</span>):</p>
<ul>
<li><span class="math inline">P(Y \leq a) = F(a)</span></li>
<li><span class="math inline">P(Y &gt; a) = 1 - F(a)</span></li>
<li><span class="math inline">P(Y &lt; a) = F(a) - \pi(a)</span></li>
<li><span class="math inline">P(Y \geq a) = 1 - P(Y &lt; a)</span></li>
<li><span class="math inline">P(a &lt; Y \leq b) = F(b) - F(a)</span></li>
<li><span class="math inline">P(a &lt; Y &lt; b) = F(b) - F(a) - \pi(b)</span></li>
<li><span class="math inline">P(a \leq Y \leq b) = F(b) - F(a) + \pi(a)</span></li>
<li><span class="math inline">P(a \leq Y &lt; b) = P(a \leq Y \leq b) - \pi(b)</span></li>
</ul>
</div>
<p><br></p>
<p>Some CDFs have jumps/steps, and some CDFs are smooth/continuous. If <span class="math inline">F</span> has a jump at domain point <span class="math inline">a</span>, then the PMF at <span class="math inline">a</span> is <span id="eq-PMFjumps"><span class="math display">
  \pi(a) = P(Y=a) = F(a) - \lim_{\epsilon \to 0} F(a-\epsilon) = \text{``jump height at} \ a\text{''.}
\tag{2.1}</span></span> If <span class="math inline">F</span> is continuous at domain point <span class="math inline">a</span>, we have <span class="math inline">\lim_{\epsilon \to 0} F(a-\epsilon) = F(a)</span>, which implies that <span class="math inline">\pi(a) = P(Y=a) = 0</span>.</p>
<p>We call the random variable a <strong>discrete random variable</strong> if the CDF contains jumps and is flat between the jumps. A discrete random variable has only a finite (or countably infinite) number of potential outcomes. The values of the PMF correspond to the jump heights in the CDF as defined in <a href="#eq-PMFjumps" class="quarto-xref">Equation&nbsp;<span>2.1</span></a>. The <strong>support</strong> <span class="math inline">\mathcal Y</span> of a discrete random variable <span class="math inline">Y</span> is the set of all points <span class="math inline">a \in \mathbb R</span> with nonzero probability mass, i.e.&nbsp;<span class="math inline">\mathcal{Y} = \{ a \in \mathbb{R} : \pi(a) &gt; 0 \}</span>. The probabilities of a discrete random variable sum to 1, i.e., <span class="math inline">\sum_{a \in \mathcal Y} \pi(a)= 1</span>.</p>
<p>The Bernoulli variables <em>coin</em> and <em>female</em> are discrete random variables with support <span class="math inline">\mathcal Y = \{0,1\}</span>. The variable <em>eduaction</em> has support <span class="math inline">\mathcal Y = \{4, 10, 12, 13, 14, 16, 18, 21\}</span>. A Poisson random variable has thr support <span class="math inline">\mathcal Y = \mathbb N \cup \{0\}</span>.</p>
<p>We call a random variable a <strong>continuous random variable</strong> if the CDF is continuous at every point <span class="math inline">a \in \mathbb R</span>. A continuous random variable has <span class="math inline">\pi(a) = P(Y=a) = 0</span> for all <span class="math inline">a \in \mathbb R</span>. The basic rules for the CDF become simpler in the case of a continuous random variable:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>Rules for the CDF of a continuous random variable (for <span class="math inline">a &lt; b</span>):</p>
<ul>
<li><span class="math inline">P(Y \leq a) = P(Y &lt; a) = F(a)</span></li>
<li><span class="math inline">P(Y \geq a) = P(Y &gt; a) = 1 - F(a)</span></li>
<li><span class="math inline">P(a &lt; Y \leq b) = P(a \leq Y &lt; b) = F(b) - F(a)</span></li>
<li><span class="math inline">P(a &lt; Y &lt; b) = P(a \leq Y \leq b) = F(b) - F(a)</span></li>
</ul>
</div>
<p><br></p>
<p>Single-outcome events are null sets and occur with probability zero. Therefore, the PMF is not suitable to describe the distribution of a continuous random variable. We use the CDF to compute probabilities of interval events as well as their unions, intersections, and complements.</p>
<div id="fig-CDFwage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4CDF2.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.5: CDF of wage evaluated at some points
</figcaption></figure>
</div>
<p>For instance, <span class="math inline">P(Y \leq 30) = 0.942</span>, <span class="math inline">P(Y \leq 20) = 0.779</span>, <span class="math inline">P(Y \leq 10) = 0.217</span>, and <span class="math inline">P(10 \leq Y \leq 20) = 0.779 - 0.217 = 0.562</span>.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Quantiles</strong></p>
<p>For a continuous random variable <span class="math inline">Y</span> the <span style="color:orange"><span class="math inline">\alpha</span>-quantile</span> <span class="math inline">q(\alpha)</span> is defined as the solution to the equation <span class="math inline">\alpha = F(q(\alpha))</span>, or, equivalently, as the inverse of the distribution function: <span class="math display">
        q(\alpha) = F^{-1}(\alpha)
    </span></p>
</div>
<p><br></p>
<ul>
<li>
<span class="math inline">q(\cdot)</span> is a function from <span class="math inline">(0,1)</span> to <span class="math inline">\mathbb R</span>.</li>
<li>Some quantiles have special names:
<ul>
<li>The <span style="color:orange">median</span> is the 0.5 quantile.</li>
<li>The <span style="color:orange">quartiles</span> are the 0.25, 0.5 and 0.75 quantiles.</li>
<li>The <span style="color:orange">deciles</span> are the 0.1, 0.2,… , 0.9 quantiles.</li>
</ul>
</li>
</ul>
<div id="fig-CDFwage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4CDF3.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.6: Quantiles of variable wage
</figcaption></figure>
</div>
<p>From the quantile plot, we find that <span class="math inline">q(0.1) = 7.73</span>, <span class="math inline">q(0.5) = 13.90</span>, <span class="math inline">q(0.9) = 26.18</span>. Under this wage distribution, the median wage is 13.90 EUR, the poorest 10% have a wage of less than 7.33 EUR, and the richest 10% have a wage of more than 26.18 EUR.</p>
<div id="fig-CDFwage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex3Q.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.7: Quantiles of variable education
</figcaption></figure>
</div>
<p>The median of <em>education</em> is 13, the 0.1-quantile is 12, and the 0.9-quantile is 18.</p>
<p>A CDF has the following properties:</p>
<ol type="i">
<li>it is <em>non-decreasing</em>,</li>
<li>it is <em>right-continuous</em> (jumps may occur only when the limit point is approached from the left)</li>
<li>the left limit is zero: <span class="math inline">\lim_{a \to -\infty} F(a) = 0</span>
</li>
<li>the right limit is one: <span class="math inline">\lim_{a \to \infty} F(a) = 1</span>.</li>
</ol>
<p>Any function <span class="math inline">F</span> that satisfies these four properties defines a probability distribution. Typically, distributions are divided into discrete and continuous distributions. Still, it may be the case that a distribution does not fall into either of these categories (for instance, if a CDF has jumps on some domain points and is continuously increasing on other domain intervals). In any case, the CDF characterizes the entire distribution of any random variable.</p>
</section><section id="probability-density-function" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="probability-density-function">
<span class="header-section-number">2.6</span> Probability density function</h2>
<p>For discrete random variables, both the PMF and the CDF characterize the distribution. In the case of a continuous random variable, the PMF does not yield any information about the distribution since it is zero. The continuous counterpart of the PMF is the density function:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Probability density function</strong></p>
<p>The <span style="color:orange">probability density function (PDF)</span> or simply <span style="color:orange">density function</span> of a continuous random variable <span class="math inline">Y</span> is a function <span class="math inline">f(a)</span> that satisfies <span class="math display">
    F(a) = \int_{-\infty}^a f(u) \ \text{d}u
</span> The density <span class="math inline">f(a)</span> is the derivative of the CDF <span class="math inline">F(a)</span> if it is differentiable: <span class="math display">
    f(a) = \frac{d}{da} F(a).
</span></p>
</div>
<p><br></p>
<p>Properties of a PDF:</p>
<ol type="i">
<li><p><span class="math inline">f(a) \geq 0</span> for all <span class="math inline">a \in \mathbb R</span></p></li>
<li><p><span class="math inline">\int_{-\infty}^\infty f(u) \ \text{d}u = 1</span></p></li>
</ol>
<div id="fig-PDFwage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-PDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4PDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.8: PDF of the variable wage
</figcaption></figure>
</div>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>Probability rule for the PDF: <span class="math display">
  P(a &lt; Y &lt; b) = \int_a^b f(u) \ \text{d} u = F(b) - F(a)
</span></p>
</div>
<p><br></p>
</section><section id="expected-value" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="expected-value">
<span class="header-section-number">2.7</span> Expected value</h2>
<p>The <strong>expectation</strong> or <strong>expected value</strong> is the most important measure of the central tendency of a distribution. It gives you the average value you can expect to get if you repeat the random experiment multiple times. We define the expectation first for discrete random variables, then continuous random variables, and finally give a unified definition for all random variables.</p>
<section id="expectation-of-a-discrete-random-variable" class="level3" data-number="2.7.1"><h3 data-number="2.7.1" class="anchored" data-anchor-id="expectation-of-a-discrete-random-variable">
<span class="header-section-number">2.7.1</span> Expectation of a discrete random variable</h3>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>The <strong>expectation</strong> or <strong>expected value</strong> of a discrete random variable <span class="math inline">Y</span> with PMF <span class="math inline">\pi(\cdot)</span> and support <span class="math inline">\mathcal Y</span> is defined as <span class="math display">
    E[Y] =
    \sum_{u \in \mathcal Y} u \pi(u).
</span></p>
</div>
<p>For the <em>coin</em> variable, we have <span class="math inline">\mathcal Y = \{0,1\}</span> and therefore <span class="math display">
  E[Y] = 0\cdot\pi(0) + 1\cdot\pi(1) = 0.5.
</span> For the variable <em>education</em> we get <span class="math display">\begin{align*}
  E[Y] &amp;= 4\cdot\pi(4) + 10\cdot\pi(10) + 12\cdot \pi(12) \\
  &amp;\phantom{=} + 13\cdot\pi(13) + 14\cdot\pi(14) + 16\cdot \pi(16) \\
  &amp;\phantom{=} + 18 \cdot \pi(18) + 21*\pi(21) = 13.557
\end{align*}</span></p>
<p>The expectation of a Poisson distributed random variable <span class="math inline">Y</span> with parameter <span class="math inline">\lambda</span> is <span class="math display">
  E[Y] = 0+ \sum_{a=1}^\infty a \cdot e^{-\lambda}\frac{\lambda^a}{a!} =
e^{-\lambda} \sum_{a=1}^\infty \frac{\lambda^a}{(a-1)!} = e^{-\lambda} \sum_{a=0}^\infty \frac{\lambda^{a+1}}{a!} = \lambda e^{-\lambda} e^{\lambda} = \lambda.
</span></p>
</section><section id="expectation-of-a-continuous-random-variable" class="level3" data-number="2.7.2"><h3 data-number="2.7.2" class="anchored" data-anchor-id="expectation-of-a-continuous-random-variable">
<span class="header-section-number">2.7.2</span> Expectation of a continuous random variable</h3>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>The <strong>expectation</strong> or <strong>expected value</strong> of a of a continuous random variable <span class="math inline">Y</span> with PDF <span class="math inline">f(\cdot)</span> is <span class="math display">
    E[Y] =
    \int_{-\infty}^\infty u f(u) \ \text{d}u.
</span></p>
</div>
<p>Using numerical integration for the density of <a href="stat4_expectation.html#fig-PDFwage" class="quarto-xref">Figure&nbsp;<span>6.2</span></a> yields the expected value of 16.45 EUR for the wage variable, which is larger than the median value of 13.90 EUR. If the mean is larger than the median, we have a positively skewed distribution, meaning that a few people have high salaries, and many people have medium and low wages.</p>
<p>The uniform distribution on the unit interval <span class="math inline">[0,1]</span> has the PDF <span class="math display">
  f(u) = \begin{cases} 1 &amp; \text{if} \ u \in[0,1], \\ 0 &amp; \text{otherwise,} \end{cases}
</span> and the expected value of a uniformly distributed random variable <span class="math inline">Y</span> is <span class="math display">
  E[Y] = \int_{-\infty}^\infty u f(u) \ \text{d} u = \int_{0}^1 u \ \text{d} u = \frac{1}{2}.
</span></p>
</section><section id="sec-unifiedexpectation" class="level3" data-number="2.7.3"><h3 data-number="2.7.3" class="anchored" data-anchor-id="sec-unifiedexpectation">
<span class="header-section-number">2.7.3</span> Expectation for general random variables</h3>
<p>We can also define the expected value in a unified way for any random variable so we do not have to distinguish between discrete and continuous random variables. Let <span class="math inline">F(\cdot)</span> be the CDF of the random variable of interest and consider the differential <span class="math inline">\text{d} F(u)</span>, which corresponds to an infinitesimal change in <span class="math inline">F(\cdot)</span> at <span class="math inline">u</span>. For a discrete random variable, <span class="math inline">F(u)</span> changes only if there is a step/jump at <span class="math inline">u</span> and zero otherwise because it is flat. Thus, for a discrete distribution, <span class="math display">
  \text{d} F(u) = \begin{cases} \pi(u) &amp; \text{if} \ u \in \mathcal Y \\
  0 &amp; \text{if} \ u \notin \mathcal Y. \end{cases}
</span> In the case of a continuous random variable with differentiable CDF <span class="math inline">F(\cdot)</span>, we have <span class="math display">
  \text{d} F(u) = f(u) \ \text{d}u,
</span> where <span class="math inline">f(\cdot)</span> is the PDF of the random variable. This gives rise to the following unified definition of the expected value:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>The <strong>expectation</strong> or <strong>expected value</strong> of any random variable with CDF <span class="math inline">F(\cdot)</span> is defined as <span id="eq-Exp-Stieltjes"><span class="math display">
  E[Y] =
    \int_{-\infty}^\infty u \ \text{d}F(u).
\tag{2.2}</span></span></p>
</div>
<p><br></p>
<p>Note that <a href="#eq-Exp-Stieltjes" class="quarto-xref">Equation&nbsp;<span>2.2</span></a> is the Riemann-Stieltjes integral of <span class="math inline">a</span> with respect to the function <span class="math inline">F(\cdot)</span>. Recall that the Riemann integral of <span class="math inline">u</span> with respect to <span class="math inline">u</span> over the interval <span class="math inline">[-1,1]</span> is <span class="math display">\int_{-1}^1 u \ \text{d} u := \lim_{N\to \infty} \sum_{j=1}^{2N} \Big(\frac{j}{N} - 1\Big) \Big(\big(\tfrac{j}{N} - 1\big) - \big(\tfrac{j-1}{N} - 1 \big)\Big) = \lim_{N\to \infty} \sum_{j=1}^{2N} \Big(\frac{j}{N} - 1\Big) \frac{1}{N},</span> for the interval <span class="math inline">[-z,z]</span> we have <span class="math display">\int_{-z}^z u \ \text{d} u := \lim_{N\to \infty} \sum_{j=1}^{2N} z\Big(\frac{j}{N} - 1\Big) \frac{z}{N},</span> and we obtain <span class="math inline">\int_{-\infty}^\infty u \ \text{d} u := \lim_{z \to \infty} \int_{-z}^z u \ \text{d} u</span> for the integral over the entire real line. Note that <span class="math inline">z/N = z(\frac{j}{N}-1) - z(\frac{j-1}{N}-1)</span> corresponds to a change in <span class="math inline">u</span> on <span class="math inline">[-z,z]</span> so we approximate <span class="math display">
\text{d} u \approx z\big(\tfrac{j}{N}-1\big) - z\big(\tfrac{j-1}{N}-1\big) = \tfrac{z}{N}
</span> and let <span class="math inline">N</span> tend to infinity. In the case of the Riemann-Stieltjes integral, where we integrate with respect to changes in a function <span class="math inline">F(\cdot)</span>, i.e., <span class="math inline">\text{d} F(u)</span>. In an interval <span class="math inline">[-z,z]</span>, we have <span class="math display">\text{d} F(u) \approx F\Big(z\big(\tfrac{j}{N}-1\big)\Big) - F\Big(z\big(\tfrac{j-1}{N}-1\big)\Big),</span> and we define <span class="math display">\begin{align*}
  \int_{-z}^z u \ \text{d}F(u) &amp;:= \lim_{N \to \infty} \sum_{j=1}^{2N} z\Big(\tfrac{j}{N} - 1\Big) F\Big(z\big(\tfrac{j}{N}-1\big)\Big) - F\Big(z\big(\tfrac{j-1}{N}-1\big)\Big) \\
  \int_{-\infty}^\infty u \ \text{d}F(u) &amp;:= \lim_{z\to \infty} \int_{-z}^z u \ \text{d}F(u)
\end{align*}</span></p>
</section><section id="properties-of-the-expected-value" class="level3" data-number="2.7.4"><h3 data-number="2.7.4" class="anchored" data-anchor-id="properties-of-the-expected-value">
<span class="header-section-number">2.7.4</span> Properties of the expected value</h3>
<p>The expected value is a measure of central tendency. It is a <strong>linear</strong> function. For any two random variables <span class="math inline">Y</span> and <span class="math inline">Z</span> and any <span class="math inline">a,b \in \mathbb R</span>, we have <span class="math display">
  E[aY + bZ] = a E[Y] + b E[Z].
</span></p>
<p>The expected value has some optimality properties in terms of prediction. The best predictor of a random variable <span class="math inline">Y</span> in the mean square error sense is the value <span class="math inline">g^*</span> that minimizes <span class="math inline">E[(Y-g)^2]</span> over <span class="math inline">g</span>. We have <span class="math display">
  E[(Y-g)^2] = E[Y^2] -2gE[Y] + g^2,
</span> and minimizing over <span class="math inline">g</span> yields <span class="math display">
  \frac{\text{d}E[(Y-g)^2]}{\text{d}g} = -2E[Y] + 2g,
</span> which is zero if <span class="math inline">g=E[Y]</span>. The second derivative is positive. Therefore, the expected value is the <strong>best predictor</strong> for a random variable if you do not have any further information available.</p>
<p>We often transform random variables by taking, for instance, squares <span class="math inline">Y^2</span> or logs <span class="math inline">\log(Y)</span>. For any transformation function <span class="math inline">g(\cdot)</span>, the expectation of the transformed random variable <span class="math inline">g(Y)</span> is <span class="math display">
  E[g(Y)] = \int_{-\infty}^\infty g(u) \ \text{d}F(u),
</span> where <span class="math inline">\text{d}F(u)</span> can be replaced by the PMF or the PDF as discussed in <a href="#sec-unifiedexpectation" class="quarto-xref"><span>Section 2.7.3</span></a> for the different cases. For instance, if we take the <em>coin</em> variable <span class="math inline">Y</span> and consider the transformed random variable <span class="math inline">\log(Y+1)</span>, the expected value is <span class="math display">
  E[\log(Y+1)] = \log(1) \cdot \frac{1}{2} + \log(2) \cdot \frac{1}{2} = \frac{\log(2)}{2}
</span></p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Moments</strong></p>
<p>The <span style="color:orange"><span class="math inline">r</span>-th moment</span> of a random variable <span class="math inline">Y</span> is defined as <span class="math display">
    E[Y^r] = \int_{-\infty}^\infty u^r \ \text{d}F(u) = \begin{cases}
      \sum_{u \in \mathcal Y} u^r \pi(u) &amp; \text{if} \ Y \ \text{is discrete,} \\
      \int_{-\infty}^\infty u^r f(u)\text{d}u &amp; \text{if} \ Y \ \text{is continuous.} \end{cases}
  </span></p>
</div>
</section></section><section id="descriptive-features-of-a-distribution" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="descriptive-features-of-a-distribution">
<span class="header-section-number">2.8</span> Descriptive features of a distribution</h2>
<table class="caption-top table">
<caption>Some important features of the distribution of <span class="math inline">Y</span>
</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 42%">
<col style="width: 6%">
</colgroup>
<tbody>
<tr class="odd">
<td><span class="math inline">E[Y^r]</span></td>
<td>
<span style="color:orange"><span class="math inline">r</span>-th moment</span> of <span class="math inline">Y</span>
</td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">E[(Y-E[Y])^r]</span></td>
<td>
<span style="color:orange"><span class="math inline">r</span>-th central moment</span> of <span class="math inline">Y</span>
</td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">Var[Y] = E[(Y-E[Y])^2]</span></td>
<td>
<span style="color:orange">variance</span> of <span class="math inline">Y</span>
</td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">sd(Y) = \sqrt{Var[Y]}</span></td>
<td>
<span style="color:orange">standard deviation</span> of <span class="math inline">Y</span>
</td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">E[((Y-E[Y])/sd(Y))^r]</span></td>
<td colspan="2">
<span style="color:orange"><span class="math inline">r</span>-th standardized moment</span> of <span class="math inline">Y</span>
</td>
</tr>
<tr class="even">
<td><span class="math inline">skew = E[((Y-E[Y])/sd(Y))^3]</span></td>
<td colspan="2">
<span style="color:orange">skewness</span> of <span class="math inline">Y</span>
</td>
</tr>
<tr class="odd">
<td><span class="math inline">kurt = E[((Y-E[Y])/sd(Y))^4]</span></td>
<td colspan="2">
<span style="color:orange">kurtosis</span> of <span class="math inline">Y</span>
</td>
</tr>
</tbody>
</table>
<p>The mean is a measure of central tendency and equals the expected value. The variance and standard deviation are measures of dispersion. We have <span class="math display">
  Var[Y] = E[(Y-E[Y])^2] = E[Y^2] - E[Y]^2
</span> and <span class="math display">
  Var[a+bY] = b^2 Var[Y]
</span> for any <span class="math inline">a,b \in \mathbb R</span>. The skewness <span class="math display">
  skew = \frac{E[(Y - E[Y])^3]}{sd(Y)^3} =\frac{E[Y^3] - 3 E[Y^2] E[Y] + 2 E[Y]^3}{(E[Y^2] - E[Y]^2)^{3/2}}
</span> is a measure of asymmetry</p>
<div id="fig-skewness" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-skewness-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img_zusatz/skewness.svg" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-skewness-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.9: Positive and negative skewness
</figcaption></figure>
</div>
<p>A random variable <span class="math inline">Y</span> has a <strong>symmetric distribution</strong> about 0 if <span class="math inline">F(u) = 1 - F(-u)</span>. If <span class="math inline">Y</span> has a density, it is symmetric if <span class="math inline">f(x) = f(-x)</span>. If <span class="math inline">Y</span> is symmetric about 0, then the skewness is 0. The skewness of the variable <em>wage</em> (see <a href="stat4_expectation.html#fig-PDFwage" class="quarto-xref">Figure&nbsp;<span>6.2</span></a>) is positive, i.e., the distribution is positively skewed. The <strong>standard normal distribution</strong> <span class="math inline">\mathcal N(0,1)</span> , which has the density <span class="math display">
  f(u) = \phi(u) = \frac{1}{\sqrt{2\pi}} e^{-u^2/2}.
</span></p>
<p>Below you find a plot of the PDFs of <span class="math inline">N(0,1)</span> together with the <span class="math inline">t_5</span>-distribution, which is the <span class="math inline">t</span>-distribution with 5 degrees of freedom:</p>
<div id="fig-N01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-N01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-N(0,1).png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-N01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.10: PDFs of the standard normal distribution (solid) and the <span class="math inline">t_5</span>-distribution (dashed)
</figcaption></figure>
</div>
<p>The standard normal distribution and the t(5) distribution have skewness 0. The kurtosis <span class="math display">
  kurt = \frac{E[(Y - E[Y])^4]}{sd(Y)^4} =\frac{E[Y^4] - 4 E[Y^3] E[Y] + 6 E[Y^2]E[Y]^2 - 3 E[Y]^4 }{(E[Y^2] - E[Y]^2)^2}
</span> is a measure of how likely extreme outliers are. The standard normal distribution has kurtosis 3 and the t(5) distribution has kurtosis 9 so that outliers in <span class="math inline">t(5)</span> are more likely than in <span class="math inline">\mathcal N(0,1)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, cex.main<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"1000 simulated values of N(0,1)"</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">rt</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">5</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"1000 simulated values of t(5)"</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="sec02_probability_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The kurtosis of the variable <em>wage</em> is also larger than 3, meaning outliers are much more likely than in the standard normal distribution. In this case, the positive skewness means that more people have a wage less than the average, and the large kurtosis means that there are very few people with exceptionally high salaries (outliers).</p>
<p>All features discussed above are functions of the first four moments <span class="math inline">E[Y]</span>, <span class="math inline">E[Y^2]</span>, <span class="math inline">E[Y^3]</span> and <span class="math inline">E[Y^4]</span>.</p>
<section id="heavy-tailed-distributions" class="level3" data-number="2.8.1"><h3 data-number="2.8.1" class="anchored" data-anchor-id="heavy-tailed-distributions">
<span class="header-section-number">2.8.1</span> Heavy-tailed distributions</h3>
<p>Expectations might be infinity. For instance, the simple Pareto distribution has the PDF <span class="math display">
  f(a) = \begin{cases} \frac{1}{a^2} &amp; \text{if} \ a &gt; 1, \\
  0 &amp; \text{if} \ a \leq 1, \end{cases}
</span> and the expected value is <span class="math display">
  E[X] = \int_{-\infty}^\infty a f(a) \ \text{d}a
  = \int_{1}^\infty  \frac{1}{a} \ \text{d}a = \log(a)|_1^\infty = \infty.
</span> The game of chance from the St.&nbsp;Petersburg paradox (see <a href="https://en.wikipedia.org/wiki/St._Petersburg_paradox">https://en.wikipedia.org/wiki/St._Petersburg_paradox</a>) is an example of a discrete random variable with infinite expectation.</p>
<p>There are distributions with finite mean with some higher moments that are infinite. For instance, the first <span class="math inline">m-1</span> moments of the <span class="math inline">t_m</span> distribution (Student’s-<span class="math inline">t</span> distribution with <span class="math inline">m</span> degrees of freedom) are finite, but the <span class="math inline">m</span>-th moment and all higher order moments are infinite. Random variables with infinite first four moments have a so-called <strong>heavy-tailed distribution</strong> and may produce huge outliers. Many statistical procedures are only valid if the underlying distribution is not heavy-tailed.</p>
</section></section><section id="the-normal-distribution" class="level2" data-number="2.9"><h2 data-number="2.9" class="anchored" data-anchor-id="the-normal-distribution">
<span class="header-section-number">2.9</span> The normal distribution</h2>
<p>A random variable <span class="math inline">X</span> is <span style="color:orange">normally distributed</span> with parameters <span class="math inline">(\mu, \sigma^2)</span> if it has the density <span class="math display">
    f(a \mid \mu, \sigma^2) = \frac{1}{\sqrt{2 \pi \sigma^2}} \exp\Big( - \frac{(a- \mu)^2}{2 \sigma^2} \Big).
  </span> We write <span class="math inline">Y \sim \mathcal N(\mu, \sigma^2)</span>. Mean and variance are <span class="math display">
        E[Y] = \mu, \quad var[Y] = \sigma^2.
    </span> Special case: <span style="color:blue">standard normal distribution</span> <span class="math inline">\mathcal{N}(0,1)</span> with density <span class="math display">
    \phi(a) = \frac{1}{\sqrt{2 \pi}} \exp\Big( - \frac{a^2}{2} \Big)
  </span> and CDF <span class="math display">
    \Phi(a) = \int_{-\infty}^a \phi(u)\text{d}u.
  </span> <span class="math inline">\mathcal N(0,1)</span> is symmetric around zero: <span class="math display">
    \phi(a) = \phi(-a), \quad \Phi(a) = 1 - \Phi(-a)
</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span>, lwd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">9</span>,by<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">""</span>,xlab<span class="op">=</span><span class="st">""</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span> <span class="st">"PDF of N(2,2)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">""</span>,xlab<span class="op">=</span><span class="st">""</span>, type<span class="op">=</span><span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"CDF of N(2,2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="sec02_probability_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If <span class="math inline">Y_1, \ldots, Y_n</span> are normally distributed and <span class="math inline">c_1, \ldots, c_n \in \mathbb R</span>, then <span class="math inline">\sum_{j=1}^n c_j Y_j</span> is normally distributed.</p>
</section><section id="additional-reading" class="level2" data-number="2.10"><h2 data-number="2.10" class="anchored" data-anchor-id="additional-reading">
<span class="header-section-number">2.10</span> Additional reading</h2>
<ul>
<li>Stock and Watson (2019), Section 2</li>
<li>Hansen (2022a), Section 1-2</li>
<li>Davidson and MacKinnon (2004), Section 1</li>
</ul></section><section id="r-codes" class="level2" data-number="2.11"><h2 data-number="2.11" class="anchored" data-anchor-id="r-codes">
<span class="header-section-number">2.11</span> R-codes</h2>
<p><a href="https://statistics.svenotto.com/statistics-sec2.R">statistics-sec2.R</a></p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./part1_distribution.html" class="pagination-link" aria-label="Distribution">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Distribution</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sec03_dependence.html" class="pagination-link" aria-label="Dependence">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dependence</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>