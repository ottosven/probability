<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Expectated value – Probability Theory for Econometricians</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat5_conditional.html" rel="next">
<link href="./stat3_probability.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="6&nbsp; Expectated value – Probability Theory for Econometricians">
<meta property="og:description" content="">
<meta property="og:site_name" content="Probability Theory for Econometricians">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat4_expectation.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Expectated value</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Probability Theory for Econometricians</a> 
        <div class="sidebar-tools-main">
    <a href="./Probability-Theory-for-Econometricians.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part1_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec02_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec03_dependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dependence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat1_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat3_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat4_expectation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Expectated value</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat5_conditional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Conditional expectation</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#discrete-random-variables" id="toc-discrete-random-variables" class="nav-link active" data-scroll-target="#discrete-random-variables"><span class="header-section-number">6.1</span> Discrete random variables</a></li>
  <li><a href="#continuous-random-variables" id="toc-continuous-random-variables" class="nav-link" data-scroll-target="#continuous-random-variables"><span class="header-section-number">6.2</span> Continuous random variables</a></li>
  <li><a href="#sec-unifiedE" id="toc-sec-unifiedE" class="nav-link" data-scroll-target="#sec-unifiedE"><span class="header-section-number">6.3</span> Unified definition of the expected value</a></li>
  <li><a href="#transformed-variables" id="toc-transformed-variables" class="nav-link" data-scroll-target="#transformed-variables"><span class="header-section-number">6.4</span> Transformed variables</a></li>
  <li><a href="#linearity-of-the-expected-value" id="toc-linearity-of-the-expected-value" class="nav-link" data-scroll-target="#linearity-of-the-expected-value"><span class="header-section-number">6.5</span> Linearity of the expected value</a></li>
  <li><a href="#parameters-and-estimators" id="toc-parameters-and-estimators" class="nav-link" data-scroll-target="#parameters-and-estimators"><span class="header-section-number">6.6</span> Parameters and estimators</a></li>
  <li><a href="#estimation-of-the-mean" id="toc-estimation-of-the-mean" class="nav-link" data-scroll-target="#estimation-of-the-mean"><span class="header-section-number">6.7</span> Estimation of the mean</a></li>
  <li><a href="#consistency" id="toc-consistency" class="nav-link" data-scroll-target="#consistency"><span class="header-section-number">6.8</span> Consistency</a></li>
  <li><a href="#law-of-large-numbers" id="toc-law-of-large-numbers" class="nav-link" data-scroll-target="#law-of-large-numbers"><span class="header-section-number">6.9</span> Law of large numbers</a></li>
  <li><a href="#heavy-tails" id="toc-heavy-tails" class="nav-link" data-scroll-target="#heavy-tails"><span class="header-section-number">6.10</span> Heavy tails</a></li>
  <li><a href="#sec-varianceest" id="toc-sec-varianceest" class="nav-link" data-scroll-target="#sec-varianceest"><span class="header-section-number">6.11</span> Estimation of the variance</a></li>
  <li><a href="#bias-variance-tradeoff" id="toc-bias-variance-tradeoff" class="nav-link" data-scroll-target="#bias-variance-tradeoff"><span class="header-section-number">6.12</span> Bias-variance tradeoff</a></li>
  <li><a href="#r-codes" id="toc-r-codes" class="nav-link" data-scroll-target="#r-codes"><span class="header-section-number">6.13</span> R-codes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Expectated value</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="https://statistics.svenotto.com/section5_expectation.pdf">PDF version</a></p>
<p>The <strong>expectation</strong> or <strong>expected value</strong> is the most important measure of the central tendency of a distribution. It gives you the average value you can expect to get if you repeat the random experiment multiple times. We define the expectation first for discrete random variables, then continuous random variables, and finally give a unified definition for all random variables.</p>
<section id="discrete-random-variables" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="discrete-random-variables"><span class="header-section-number">6.1</span> Discrete random variables</h2>
<p>Recall that a discrete random variable <span class="math inline">Y</span> is a variable that can take on a countable number of distinct values. Each possible value <span class="math inline">a</span> has an associated probability <span class="math inline">\pi(a)=P(Y=a)</span>, known as the probability mass function (PMF).</p>
<p>The support <span class="math inline">\mathcal Y</span> of <span class="math inline">Y</span> is the set of all values that <span class="math inline">Y</span> can take with non-zero probability: <span class="math display">\mathcal{Y} = \{ a \in \mathbb{R} : \pi(a) &gt; 0 \}.</span> The total probability sums to 1: <span class="math inline">\sum_{a \in \mathcal Y} \pi(a)= 1</span>.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>The <strong>expectation</strong> or <strong>expected value</strong> of a discrete random variable <span class="math inline">Y</span> with PMF <span class="math inline">\pi(\cdot)</span> and support <span class="math inline">\mathcal Y</span> is defined as <span id="eq-expectation-discrete"><span class="math display">
    E[Y] =
    \sum_{u \in \mathcal Y} u \pi(u).
\tag{6.1}</span></span></p>
</div>
<p>The expected value of the variable <em>education</em> from the previous section is calculated by summing over all possible values: <span class="math display">\begin{align*}
  E[Y] &amp;= 4\cdot\pi(4) + 10\cdot\pi(10) + 12\cdot \pi(12) \\
  &amp;\phantom{=} + 13\cdot\pi(13) + 14\cdot\pi(14) + 16\cdot \pi(16) \\
  &amp;\phantom{=} + 18 \cdot \pi(18) + 21 \cdot \pi(21) = 14.117
\end{align*}</span></p>
<p>A <strong>binary</strong> or <strong>Bernoulli</strong> random variable <span class="math inline">Y</span> takes on only two possible values: 0 and 1. The support is <span class="math inline">\mathcal Y = \{0,1\}</span>. The probabilities are</p>
<ul>
<li><span class="math inline">\pi(1) = P(Y=1) = p</span></li>
<li><span class="math inline">\pi(0) = P(Y=0) = 1-p</span></li>
</ul>
<p>for some <span class="math inline">p \in (0,1)</span>. The expected value of <span class="math inline">Y</span> is: <span class="math display">\begin{align*}
  E[Y] &amp;=0\cdot\pi(0) + 1\cdot\pi(1) \\
  &amp;= 0 \cdot(1-p) + 1 \cdot p \\
  &amp;= p.
\end{align*}</span> For the variable <em>coin</em>, the probability of heads is <span class="math inline">p=0.5</span> and the expected value is <span class="math inline">E[Y] = p = 0.5</span>.</p>
</section>
<section id="continuous-random-variables" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="continuous-random-variables"><span class="header-section-number">6.2</span> Continuous random variables</h2>
<p>For discrete random variables, both the PMF and the CDF characterize the distribution. For continuous random variables, the PMF concept does not apply because the probability of any specific point is zero. The continuous counterpart of the PMF is the density function:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Probability density function</strong></p>
<p>The <strong>probability density function (PDF)</strong> or simply <strong>density function</strong> of a continuous random variable <span class="math inline">Y</span> with CDF <span class="math inline">F(a)</span> is a function <span class="math inline">f(a)</span> that satisfies <span class="math display">
    F(a) = \int_{-\infty}^a f(u) \ \text{d}u
</span> If the CDF is differentiable, the density <span class="math inline">f(a)</span> is its derivative: <span class="math display">
    f(a) = \frac{d}{da} F(a).
</span></p>
</div>
<p><br>
</p>
<p>Properties of a PDF:</p>
<ol type="i">
<li><p><span class="math inline">f(a) \geq 0</span> for all <span class="math inline">a \in \mathbb R</span></p></li>
<li><p><span class="math inline">\int_{-\infty}^\infty f(u) \ \text{d}u = 1</span></p></li>
</ol>
<div id="fig-CDFwage2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-CDFwage2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4CDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFwage2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: CDF of wage
</figcaption>
</figure>
</div>
<div id="fig-PDFwage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4PDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: PDF of wage
</figcaption>
</figure>
</div>
<p>Probability rule for the PDF: <span class="math display">
  P(a &lt; Y &lt; b) = \int_a^b f(u) \ \text{d} u = F(b) - F(a)
</span></p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>The <strong>expectation</strong> or <strong>expected value</strong> of a continuous random variable <span class="math inline">Y</span> with PDF <span class="math inline">f(\cdot)</span> is <span id="eq-expectation-continuous"><span class="math display">
    E[Y] =
    \int_{-\infty}^\infty u f(u) \ \text{d}u.
\tag{6.2}</span></span></p>
</div>
<p>The uniform distribution on the unit interval <span class="math inline">[0,1]</span> has the PDF <span id="eq-uniformdensity"><span class="math display">
  f(u) = \begin{cases} 1 &amp; \text{if} \ u \in[0,1], \\ 0 &amp; \text{otherwise,} \end{cases}
\tag{6.3}</span></span> and the expected value of a uniformly distributed random variable <span class="math inline">Y</span> is <span class="math display">
  E[Y] = \int_{-\infty}^\infty u f(u) \ \text{d} u = \int_{0}^1 u \ \text{d} u = \frac{1}{2} u^2 \ \bigg|_0^1= \frac{1}{2}.
</span></p>
</section>
<section id="sec-unifiedE" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-unifiedE"><span class="header-section-number">6.3</span> Unified definition of the expected value</h2>
<p>The expected value of a random variable <span class="math inline">Y</span> can be defined in a unified way that applies to both discrete and continuous cases by using its CDF <span class="math inline">F(u)</span>: <span id="eq-expectation-unified"><span class="math display">
  E[Y] =
    \int_{-\infty}^\infty u \ \text{d}F(u).
\tag{6.4}</span></span></p>
<p>This integral, known as the <strong>Riemann-Stieltjes integral</strong>, generalizes the concept of integration to include functions that may not be smooth or differentiable everywhere.</p>
<p>For a continuous random variable with PDF <span class="math inline">f(u)</span>, the CDF <span class="math inline">F(u)</span> is smooth and differentiable. The relationship between the CDF and the PDF is: <span class="math display">\text{d}F(u)=f(u) \ \text{d}u.</span> Substituting this into our unified definition gives: <span class="math display">\begin{align*}
  E[Y] &amp;=
    \int_{-\infty}^\infty u \ \text{d}F(u) \\
    &amp;= \int_{-\infty}^\infty u f(u) \ \text{d}u,
\end{align*}</span> which matches the standard definition of the expected value for continuous random variables as in <a href="#eq-expectation-continuous" class="quarto-xref">Equation&nbsp;<span>6.2</span></a>.</p>
<p>For a discrete random variable, the CDF <span class="math inline">F(u)</span> is a step function that increases in jumps at the possible values <span class="math inline">u \in \mathcal Y</span> that <span class="math inline">Y</span> can take. The “change” or jump in the CDF at each <span class="math inline">u \in \mathcal Y</span> is: <span class="math display">
  \Delta F(u) = F(u) - F(u^-) = P(Y=u) = \pi(u),
</span> where <span class="math inline">F(u^-)</span> is the value of <span class="math inline">F(u)</span> just before <span class="math inline">u</span>, and <span class="math inline">\pi(u)</span> is the PMF of <span class="math inline">Y</span>.</p>
<p>Integrating with respect to <span class="math inline">F(u)</span> simplifies to summing over these jumps: <span class="math display">\begin{align*}
  E[Y] &amp;=
    \int_{-\infty}^\infty u \ \text{d}F(u) \\
    &amp;= \sum_{u \in \mathcal Y} u \ \Delta F(u) \\
    &amp;= \sum_{u \in \mathcal Y} u \pi(u),
\end{align*}</span> which aligns with the standard definition of the expected value for discrete random variables as in <a href="#eq-expectation-discrete" class="quarto-xref">Equation&nbsp;<span>6.1</span></a>.</p>
<p>The unified definition <span class="math inline">E[Y]= \int_{-\infty}^\infty u \ \text{d}F(u)</span> allows us to treat all types of random variables consistently, whether the variable is discrete, continuous, or a mixture of both. It can also handle non-standard cases such as distributions with CDFs that are not differentiable everywhere.</p>
</section>
<section id="transformed-variables" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="transformed-variables"><span class="header-section-number">6.4</span> Transformed variables</h2>
<p>We often transform random variables by taking, for instance, squares <span class="math inline">Y^2</span> or logs <span class="math inline">\log(Y)</span>. For any transformation function <span class="math inline">g(\cdot)</span>, the expectation of the transformed random variable <span class="math inline">g(Y)</span> is <span class="math display">
  E[g(Y)] = \int_{-\infty}^\infty g(u) \ \text{d}F(u),
</span> where <span class="math inline">F(u)</span> is the CDF of <span class="math inline">Y</span>. As discussed in <a href="#sec-unifiedE" class="quarto-xref"><span>Section 6.3</span></a> for the different cases, <span class="math inline">\text{d}F(u)</span> can be replaced by the PMF or the PDF, i.e., <span class="math display">
  \int_{-\infty}^\infty g(u) \ \text{d}F(u) = \begin{cases}
      \sum_{u \in \mathcal Y} g(u) \pi(u) &amp; \text{if} \ Y \ \text{is discrete,} \\
      \int_{-\infty}^\infty g(u) f(u)\text{d}u &amp; \text{if} \ Y \ \text{is continuous.} \end{cases}
</span></p>
<p>For instance, if we take the <em>coin</em> variable <span class="math inline">Y</span> and consider the transformed random variable <span class="math inline">\log(Y+1)</span>, the expected value is <span class="math display">
  E[\log(Y+1)] = \log(1) \cdot \frac{1}{2} + \log(2) \cdot \frac{1}{2} = \frac{\log(2)}{2}
</span> We can define the population counterparts of the sample moments and their centralized and standardized versions:</p>
<ul>
<li><strong>r-th moment</strong> of <span class="math inline">Y</span>: <span class="math display">
  E[Y^r] = \int_{-\infty}^\infty u^r \ \text{d}F(u)
</span></li>
<li><strong>r-th central moment</strong>: <span class="math display">
  E[(Y-E[Y])^r] = \int_{-\infty}^\infty (u - E[Y])^r \ \text{d}F(u)
</span></li>
<li><strong>Variance</strong> (2nd central moment): <span class="math display">
Var[Y] = E[(Y-E[Y])^2] = \int_{-\infty}^\infty (u - E[Y])^2 \ \text{d}F(u)
</span></li>
<li><strong>Standard deviation</strong>: <span class="math display">
sd(Y) = \sqrt{Var[Y]}
</span></li>
<li><strong>r-th standardized moment</strong>: <span class="math display">
E \bigg[ \Big(\frac{Y-E[Y]}{sd(Y)}\Big)^r \bigg] = \int_{-\infty}^\infty \Big(\frac{u-E[Y]}{sd(Y)}\Big)^r \ \text{d}F(u)
</span></li>
<li><strong>Skewness</strong> (3rd standardized moment): <span class="math display">
skew(Y) =  E \bigg[ \Big(\frac{Y-E[Y]}{sd(Y)}\Big)^3 \bigg]
</span></li>
<li><strong>Kurtosis</strong> (4th standardized moment): <span class="math display">
kurt(Y) = E \bigg[ \Big(\frac{Y-E[Y]}{sd(Y)}\Big)^4 \bigg]
</span></li>
</ul>
</section>
<section id="linearity-of-the-expected-value" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="linearity-of-the-expected-value"><span class="header-section-number">6.5</span> Linearity of the expected value</h2>
<p>The expected value is a <strong>linear</strong> function. For any <span class="math inline">a,b \in \mathbb R</span>, we have <span class="math display">
  E[aY + b] = a E[Y] + b.
</span> For the variance, the following rule applies: <span class="math display">
  Var[aY + b] = a^2 Var[Y].
</span></p>
<p>For any two random variables <span class="math inline">Y</span> and <span class="math inline">Z</span>, we have <span class="math display">
  E[aY + bZ] = aE[Y] + bE[Z].
</span> A similar result for the variance does not hold in general. However, if <span class="math inline">Y</span> and <span class="math inline">Z</span> are independent random variables, we have <span id="eq-varianceformula"><span class="math display">
  Var[aY + bZ] = a^2 Var[Y] + b^2 Var[Z].
\tag{6.5}</span></span></p>
</section>
<section id="parameters-and-estimators" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="parameters-and-estimators"><span class="header-section-number">6.6</span> Parameters and estimators</h2>
<p>A <strong>parameter</strong> <span class="math inline">\theta</span> is a feature (function) of the population distribution <span class="math inline">F</span> of some random variable <span class="math inline">Y</span>. The expectation, variance, skewness, and kurtosis are parameters.</p>
<p>A <strong>statistic</strong> is a function of a sample <span class="math inline">Y_1, \ldots, Y_n</span>. An <strong>estimator</strong> <span class="math inline">\widehat \theta</span> for <span class="math inline">\theta</span> is a statistic intended as a guess about <span class="math inline">\theta</span>. It is a function of the random variables <span class="math inline">Y_1, \ldots, Y_n</span> and, therefore, a random variable as well. The sample mean, sample variance, sample skewness and sample kurtosis are estimators. When an estimator <span class="math inline">\widehat \theta</span> is calculated in a specific realized sample, we call <span class="math inline">\widehat \theta</span> an <strong>estimate</strong>.</p>
</section>
<section id="estimation-of-the-mean" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="estimation-of-the-mean"><span class="header-section-number">6.7</span> Estimation of the mean</h2>
<p>The expected value <span class="math inline">E[Y]</span> is also called <strong>population mean</strong> because it is the population counterpart of the sample mean <span class="math inline">\overline Y = \frac{1}{n} \sum_{i=1}^n Y_i</span>, where the sample <span class="math inline">Y_1, \ldots, Y_n</span> is identically distributed and has the same distribution as <span class="math inline">Y</span>. In particular, we have: <span class="math display">
  E[Y_1] = \ldots = E[Y_n] = E[Y].
</span></p>
<p>The true population mean <span class="math inline">E[Y]</span> is unknown in practice, but we can use the sample mean <span class="math inline">\overline Y</span> to estimate it. The sample mean is an unbiased estimator for the population mean because <span class="math display">
  E[\overline Y] = \frac{1}{n} \sum_{i=1}^n E[Y_i] = \frac{1}{n} \sum_{i=1}^n E[Y] = E[Y].
</span> The <strong>bias</strong> of an estimator is the expected value of the estimator minus the parameter to be estimated. The bias of the sample mean is zero: <span class="math display">
  Bias[\overline Y] = E[\overline Y] - E[Y] = E[Y] - E[Y] = 0.
</span> When repeating random experiments and computing sample means, we can expect the sample means to be distributed around the true population mean, with the population mean at the center of this distribution.</p>
<p>To assess how large the spread around the true population mean is, we can compute the variance: <span class="math display">
  Var[\overline Y] = \frac{1}{n^2} Var\bigg[ \sum_{i=1}^n Y_i \bigg]
</span> To simplify this term further, let’s assume that the sample is i.i.d. (independent and identically distributed), i.e.&nbsp;the observations are randomly sampled from the population. Then, we can apply <a href="#eq-varianceformula" class="quarto-xref">Equation&nbsp;<span>6.5</span></a>: <span class="math display">
  Var\bigg[ \sum_{i=1}^n Y_i \bigg] = \sum_{i=1}^n Var[Y_i].
</span> By the identical distribution of the sample, we have <span class="math display">
  Var[Y_1] = \ldots = Var[Y_n] = Var[Y].
</span> Therefore, the variance of the sample mean becomes: <span class="math display">
  Var[\overline Y] = \frac{1}{n^2} \sum_{i=1}^n Var[Y_i] =  \frac{1}{n^2} \sum_{i=1}^n Var[Y] = \frac{Var[Y]}{n}.
</span> The spread of sample means around the true mean becomes smaller, the larger the sample size <span class="math inline">n</span> is. The more observations we have, the more precisely the sample mean can estimate the true population mean.</p>
</section>
<section id="consistency" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="consistency"><span class="header-section-number">6.8</span> Consistency</h2>
<p>Good estimators get closer and closer to the true parameter being estimated as the sample size <span class="math inline">n</span> increases, eventually returning the true parameter value in a hypothetically infinitely large sample. This property is called <strong>consistency</strong>.</p>
<div class="myborder">
<p><strong>Consistency</strong></p>
<p>An estimator <span class="math inline">\widehat \theta</span> is <strong>consistent</strong> for a true parameter <span class="math inline">\theta</span> if, for any <span class="math inline">\epsilon &gt; 0</span>, <span class="math display">
P(|\widehat \theta - \theta| &gt; \epsilon) \to 0 \qquad \text{as} \ n \to \infty.
</span> Equivalently, consistency can be defined by the complementary event: <span class="math display">
  P(|\widehat \theta - \theta| \leq \epsilon) \to 1 \qquad \text{as} \ n \to \infty.
</span> If <span class="math inline">\widehat \theta</span> is consistent, we say it <strong>converges in probability</strong> to <span class="math inline">\theta</span>, denoted by <span class="math display">
  \widehat \theta \overset{p} \to \theta \qquad \text{as} \ n \to \infty.
</span></p>
</div>
<p>If an estimator <span class="math inline">\widehat \theta</span> is a continuous random variable, it will almost never reach exactly the true parameter value because point probabilities are zero: <span class="math inline">P(\widehat \theta = \theta) = 0</span>.</p>
<p>However, the larger the sample size, the higher should be the probability that <span class="math inline">\widehat \theta</span> is close to the true value <span class="math inline">\theta</span>. Consistency means that, if we fix some small precision value <span class="math inline">\epsilon &gt; 0</span>, then, <span class="math display">P(|\widehat \theta - \theta| \leq \epsilon) = P( \theta - \epsilon \leq \widehat \theta \leq \theta + \epsilon)</span> should increase in the sample size <span class="math inline">n</span> and eventually reach 1.</p>
<p>An estimator is called <strong>inconsistent</strong> if it is not consistent. An inconsistent estimator is practically useless and leads to false inference. Therefore, it is important to verify that your estimator is consistent.</p>
<p>To show whether an estimator is consistent, we can check the sufficient condition for consistency:</p>
<div class="myborder">
<p><strong>Sufficient condition for consistency</strong></p>
<p>Let <span class="math inline">\widehat \theta</span> be an estimator for some parameter <span class="math inline">\theta</span>. The <strong>bias</strong> of <span class="math inline">\widehat \theta</span> is <span class="math display">Bias[\widehat \theta] = E[\widehat \theta] - \theta.</span></p>
<p>If the <strong>bias</strong> and the <strong>variance</strong> of <span class="math inline">\widehat \theta</span> tends to zero for large sample sizes, i.e., if</p>
<ol type="i">
<li><span class="math inline">Bias[\widehat \theta] \rightarrow 0</span> &nbsp;(as <span class="math inline">n \to \infty</span>),</li>
<li><span class="math inline">Var[\widehat \theta] \rightarrow 0</span> &nbsp;(as <span class="math inline">n \to \infty</span>),</li>
</ol>
<p>then <span class="math inline">\widehat \theta</span> is consistent for <span class="math inline">\theta</span>.</p>
</div>
<p>The reason for this sufficient condition is the fact that <span class="math display">
  P(|\widehat \theta - \theta| &gt; \epsilon) \leq Var[\widehat \theta] + Bias[\widehat \theta]^2,
</span> which follows from Markov’s inequality.</p>
</section>
<section id="law-of-large-numbers" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="law-of-large-numbers"><span class="header-section-number">6.9</span> Law of large numbers</h2>
<p>The sample mean <span class="math inline">\overline Y</span> of an i.i.d. sample is consistent for the population mean <span class="math inline">E[Y]</span> because</p>
<ol type="i">
<li><span class="math inline">Bias[\overline Y] = 0</span> for all <span class="math inline">n</span>;</li>
<li><span class="math inline">Var[\overline Y] = Var[Y]/n \to 0</span>, as <span class="math inline">n \to \infty</span>, provided <span class="math inline">Var[Y] &lt; \infty</span>.</li>
</ol>
<p>The consistency result of the sample mean is also known as the <strong>law of large numbers (LLN)</strong>: <span class="math display">
  \overline Y \overset{p} \to E[Y] \qquad \text{as} \ n \to \infty.
</span> Below is an interactive Shiny app to visualize the law of large numbers using simulated data for different sample sizes and different distributions.</p>
<div style="text-align: center; font-size: 150%;">
<p><a href="http://shiny2.svenotto.com:3838/sample-apps/LLN/">SHINY APP: LLN</a></p>
</div>
<!-- The sample mean converges quickly to the population mean in the IID standard normal, Bernoulli, t(2), and stationary AR(1) case. -->
<!-- The t(1) is a distribution with extremely heavy tails and infinite expectation. The LLN does not hold for this distribution. -->
<!-- In the random walk case, the sample mean also does not converge. The random walk $Y_t = \sum_{j=1}^t u_j$ is a nonstationary time series. The sample mean is unbiased for a random walk but has a diverging sampling variance due to the strong persistence. -->
</section>
<section id="heavy-tails" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="heavy-tails"><span class="header-section-number">6.10</span> Heavy tails</h2>
<p>The sample mean of i.i.d. samples from most distributions is consistent. However, there are some exceptional cases where consistency fails. For instance, the simple Pareto distribution has the PDF <span class="math display">
  f(u) = \begin{cases} \frac{1}{u^2} &amp; \text{if} \ u &gt; 1, \\
  0 &amp; \text{if} \ u \leq 1, \end{cases}
</span> and the expected value is <span class="math display">
  E[X] = \int_{-\infty}^\infty u f(u) \ \text{d}u
  = \int_{1}^\infty  \frac{1}{u} \ \text{d}u = \log(u)|_1^\infty = \infty.
</span> The population mean is infinity, so the sample mean cannot converge and is inconsistent. The game of chance from the St.&nbsp;Petersburg paradox (see <a href="https://en.wikipedia.org/wiki/St._Petersburg_paradox">https://en.wikipedia.org/wiki/St._Petersburg_paradox</a>) is an example of a discrete random variable with infinite expectation.</p>
<p>Another example is the t-distribution with 1 degree of freedom, also denoted as <span class="math inline">t_1</span> or Cauchy distribution, which has the PDF <span class="math display">
  f(u) = \frac{1}{\pi (1+u^2)}.
</span> The lack of consistency of the sample mean from a <span class="math inline">t_1</span> distribution is visualized in the shiny application above.</p>
<p>The Pareto, St.&nbsp;Petersburg, and Cauchy distributions have infinite population mean, and the sample mean of observations from these distributions is inconsistent. These are distributions that produce huge outliers.</p>
<p>There are other distributions that have a finite mean but an infinite variance, skewness, or kurtosis.</p>
<p>For instance, the <span class="math inline">t_2</span> distribution has a finite mean but an infinite variance. The <span class="math inline">t_3</span> distribution has a finite variance but an infinite skewness. The <span class="math inline">t_4</span> distribution has a finite skewness but an infinite kurtosis.</p>
<p>If <span class="math inline">Y</span> is <span class="math inline">t_m</span>-distributed (<span class="math inline">t</span>-distribution with <span class="math inline">m</span> degrees of freedom), then <span class="math display">
  E[Y], E[Y^2], \ldots, E[Y^{m-1}] &lt; \infty
</span> but <span class="math display">
  E[Y^m] = E[Y^{m+1}] = \ldots = \infty.
</span></p>
<p>Random variables with infinite first four moments have a so-called <strong>heavy-tailed distribution</strong> and may produce huge outliers. Many statistical procedures are only valid if the underlying distribution is not heavy-tailed.</p>
</section>
<section id="sec-varianceest" class="level2" data-number="6.11">
<h2 data-number="6.11" class="anchored" data-anchor-id="sec-varianceest"><span class="header-section-number">6.11</span> Estimation of the variance</h2>
<p>Consider an i.i.d. sample <span class="math inline">Y_1, \ldots, Y_n</span> from some population distribution with population mean <span class="math inline">\mu = E[Y]</span> and population variance <span class="math inline">\sigma^2 = Var[Y] &lt; \infty</span>.</p>
<p>We introduced two sample cointerparts of <span class="math inline">\sigma^2</span>: the sample variance <span class="math display">
  \widehat \sigma_Y^2 = \frac{1}{n} \sum_{i=1}^n (Y_i - \overline Y)^2,
</span> and the adjusted sample variance <span class="math display">
  s_Y^2 = \frac{1}{n-1} \sum_{i=1}^n (Y_i - \overline Y)^2 = \frac{n}{n-1} \widehat \sigma_Y^2.
</span></p>
<p>The sample variance can be decomposed as <span class="math display">\begin{align*}
        \widehat \sigma_Y^2 &amp;= \frac{1}{n} \sum_{i=1}^n (Y_i - \overline Y)^2
        =\frac{1}{n} \sum_{i=1}^n (Y_i - \mu + \mu - \overline Y)^2 \\
        &amp;= \frac{1}{n} \sum_{i=1}^n(Y_i - \mu)^2 + \frac{2}{n} \sum_{i=1}^n (Y_i - \mu)(\mu - \overline Y) + \frac{1}{n} \sum_{i=1}^n (\mu - \overline Y)^2 \\
        &amp;= \frac{1}{n} \sum_{i=1}^n(Y_i - \mu)^2 - 2(\overline Y - \mu)^2 + (\overline Y - \mu)^2 \\
            &amp;= \frac{1}{n} \sum_{i=1}^n(Y_i - \mu)^2  - (\overline Y - \mu)^2
    \end{align*}</span> The mean of <span class="math inline">\widehat \sigma_Y^2</span> is <span class="math display">\begin{align*}
        E[\widehat \sigma_Y^2] &amp;= \frac{1}{n} \sum_{i=1}^n E[(Y_i - \mu)^2] - E[(\overline Y - \mu)^2] = \frac{1}{n} \sum_{i=1}^n Var[Y_i] - Var[\overline Y] \\
        &amp;= \sigma^2 - \frac{\sigma^2}{n} =  \frac{n-1}{n} \sigma^2,
    \end{align*}</span> where we used the fact that <span class="math inline">Var[\overline Y] = \sigma^2/n</span>.</p>
<p>The sample variance is <strong>downward biased</strong>: <span class="math display">\begin{align*}
        Bias[\widehat \sigma_Y^2] = E[\widehat \sigma_Y^2] - \sigma^2 = \frac{n-1}{n} \sigma^2 - \sigma^2 = -\frac{\sigma^2}{n}.
    \end{align*}</span></p>
<p>On the other hand, the adjusted sample variance is <strong>unbiased</strong>:<br>
<span class="math display">\begin{align*}
        Bias[s_Y^2] = E[s_Y^2] - \sigma^2 = \frac{n}{n-1}E[\widehat \sigma_Y^2] - \sigma^2 = \sigma^2 - \sigma^2 = 0
    \end{align*}</span></p>
<p>The variance of the sample variance can be computed as <span class="math display">
  Var[\widehat \sigma_Y^2] = \frac{\sigma^4}{n} \Big( kurt - \frac{n-3}{n-1} \Big) \frac{(n-1)^2}{n^2},
</span> while the variance of the adjusted sample variance is <span class="math display">
  Var[s_Y^2] = \frac{\sigma^4}{n} \Big( kurt - \frac{n-3}{n-1} \Big).
</span> As long as the kurtosis of the underlying distribution is finite, the sufficient conditions for consistency are satisfied as the bias and variance tend to zero as <span class="math inline">n \to \infty</span>. The adjusted sample variance is unbiased for any <span class="math inline">n</span>. The sample variance is biased for fixed <span class="math inline">n</span> but <strong>asymptotically unbiased</strong> as the bias tends to zero for large <span class="math inline">n</span>. The sample variance and the adjusted sample variance are consistent for the variance if the sample is i.i.d. and the distribution is not heavy-tailed.</p>
</section>
<section id="bias-variance-tradeoff" class="level2" data-number="6.12">
<h2 data-number="6.12" class="anchored" data-anchor-id="bias-variance-tradeoff"><span class="header-section-number">6.12</span> Bias-variance tradeoff</h2>
<p>From a bias perspective, adjusted sample variance <span class="math inline">s_Y^2</span> is preferred over <span class="math inline">\widehat \sigma^2_Y</span> because <span class="math inline">s_Y^2</span> is unbiased. However, from a variance perspective, <span class="math inline">\widehat \sigma^2_Y</span> is preferred due to its smaller variance. Traditionally, the emphasis on unbiasedness has led to a preference for <span class="math inline">\widehat \sigma^2_Y</span>, even at the cost of a higher variance.</p>
<p>A more modern approach balances bias and variance, known as the <strong>bias-variance tradeoff</strong>, by selecting an estimator that minimizes the <strong>mean squared error (MSE)</strong>: <span class="math display">
  MSE(\widehat \theta) = E[(\widehat \theta - \theta)^2] = Var[\widehat \theta] + Bias[\widehat \theta]^2.
</span> For the variance estimators, the MSEs are <span class="math display">
  MSE[\widehat \sigma_Y^2] = Var[\widehat \sigma_Y^2] + Bias[\widehat \sigma_Y^2]^2 = \frac{\sigma^4}{n} \bigg[ \Big( kurt - \frac{n-3}{n-1} \Big) \frac{(n-1)^2}{n^2} + \frac{1}{n} \bigg]
</span> and <span class="math display">
  MSE[s_Y^2] = Var[s_Y^2] = \frac{\sigma^4}{n} \Big( kurt - \frac{n-3}{n-1} \Big).
</span> Since <span class="math inline">s_Y^2</span> is unbiased, its MSE equals its variance.</p>
<p>It is not possible to universally determine which estimator has a lower MSE because this depends on the population kurtosis (<span class="math inline">kurt</span>) of the underlying distribution. However, it can be shown that for all distributions with <span class="math inline">kurt \geq 1.5</span>, the relation <span class="math inline">MSE[s_Y^2] &gt; MSE[\widehat \sigma_Y^2]</span> holds, which implies that <span class="math inline">\widehat \sigma_Y^2</span> is preferred based on the bias-variance tradeoff for all moderately tailed distributions.</p>
<p>To give an indication of typical kurtosis values:</p>
<ul>
<li>Symmetric Bernoulli distribution with <span class="math inline">P(Y=0) = P(Y=1) = 0.5</span>: kurtosis of 1 (light-tailed).</li>
<li>Uniform distribution (see <a href="#eq-uniformdensity" class="quarto-xref">Equation&nbsp;<span>6.3</span></a>): kurtosis of 1.8 (moderately light-tailed).</li>
<li>Normal distribution: kurtosis of 3 (moderately tailed).</li>
<li><span class="math inline">t_5</span> distribution: kurtosis of 9 (moderately heavy-tailed).</li>
<li><span class="math inline">t_4</span> distribution: infinite kurtosis (heavy-tailed).</li>
</ul>
<p>Therefore, according to the bias-variance tradeoff, the adjusted sample variance <span class="math inline">s_Y^2</span> is preferred only for extremely light-tailed distributions, while <span class="math inline">\widehat \sigma_Y^2</span> is preferred in cases with moderate or higher kurtosis.</p>
<p>In practice, especially with larger samples, the difference between <span class="math inline">s_Y^2</span> and <span class="math inline">\widehat \sigma_Y^2</span> becomes negligible, and either estimator is generally acceptable. Therefore, the discussion about a better variance estimator is a bit nitpicky and not of much practical relevance.</p>
<p>However, for instance in high-dimensional regression problems with near multicollinearity <span class="math inline">(k \approx n)</span>, the bias-variance tradeoff is crucial. In such cases, biased but low-variance estimators like ridge or lasso (shrinkage estimators) are often preferred over ordinary least squares (OLS).</p>
</section>
<section id="r-codes" class="level2" data-number="6.13">
<h2 data-number="6.13" class="anchored" data-anchor-id="r-codes"><span class="header-section-number">6.13</span> R-codes</h2>
<p><a href="https://statistics.svenotto.com/statistics-sec05.R">statistics-sec05.R</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat3_probability.html" class="pagination-link" aria-label="Probability">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat5_conditional.html" class="pagination-link" aria-label="Conditional expectation">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Conditional expectation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>