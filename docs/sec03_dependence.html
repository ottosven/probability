<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; Dependence – Probability Theory for Econometricians</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat1_data.html" rel="next">
<link href="./sec02_probability.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="3&nbsp; Dependence – Probability Theory for Econometricians">
<meta property="og:description" content="">
<meta property="og:site_name" content="Probability Theory for Econometricians">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sec03_dependence.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dependence</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Probability Theory for Econometricians</a> 
        <div class="sidebar-tools-main">
    <a href="./Probability-Theory-for-Econometricians.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part1_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec02_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec03_dependence.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dependence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat1_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat3_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat4_expectation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Expectated value</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat5_conditional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Conditional expectation</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#multivariate-random-variables" id="toc-multivariate-random-variables" class="nav-link active" data-scroll-target="#multivariate-random-variables"><span class="header-section-number">3.1</span> Multivariate random variables</a></li>
  <li><a href="#bivariate-random-variables" id="toc-bivariate-random-variables" class="nav-link" data-scroll-target="#bivariate-random-variables"><span class="header-section-number">3.2</span> Bivariate random variables</a></li>
  <li><a href="#bivariate-distributions" id="toc-bivariate-distributions" class="nav-link" data-scroll-target="#bivariate-distributions"><span class="header-section-number">3.3</span> Bivariate distributions</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">3.4</span> Correlation</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence"><span class="header-section-number">3.5</span> Independence</a></li>
  <li><a href="#random-vectors" id="toc-random-vectors" class="nav-link" data-scroll-target="#random-vectors"><span class="header-section-number">3.6</span> Random vectors</a></li>
  <li><a href="#conditional-distributions" id="toc-conditional-distributions" class="nav-link" data-scroll-target="#conditional-distributions"><span class="header-section-number">3.7</span> Conditional distributions</a></li>
  <li><a href="#conditional-expectation" id="toc-conditional-expectation" class="nav-link" data-scroll-target="#conditional-expectation"><span class="header-section-number">3.8</span> Conditional expectation</a></li>
  <li><a href="#law-of-iterated-expectations" id="toc-law-of-iterated-expectations" class="nav-link" data-scroll-target="#law-of-iterated-expectations"><span class="header-section-number">3.9</span> Law of iterated expectations</a></li>
  <li><a href="#conditional-variance" id="toc-conditional-variance" class="nav-link" data-scroll-target="#conditional-variance"><span class="header-section-number">3.10</span> Conditional variance</a></li>
  <li><a href="#best-predictor" id="toc-best-predictor" class="nav-link" data-scroll-target="#best-predictor"><span class="header-section-number">3.11</span> Best predictor</a></li>
  <li>
<a href="#combining-normal-variables" id="toc-combining-normal-variables" class="nav-link" data-scroll-target="#combining-normal-variables"><span class="header-section-number">3.12</span> Combining normal variables</a>
  <ul class="collapse">
<li><a href="#chi2-distribution" id="toc-chi2-distribution" class="nav-link" data-scroll-target="#chi2-distribution"><span class="header-section-number">3.12.1</span> <span class="math inline">\chi^2</span>-distribution</a></li>
  <li><a href="#f-distribution" id="toc-f-distribution" class="nav-link" data-scroll-target="#f-distribution"><span class="header-section-number">3.12.2</span> <span class="math inline">F</span>-distribution</a></li>
  <li><a href="#student-t-distribution" id="toc-student-t-distribution" class="nav-link" data-scroll-target="#student-t-distribution"><span class="header-section-number">3.12.3</span> Student <span class="math inline">t</span>-distribution</a></li>
  <li><a href="#multivariate-normal-distribution" id="toc-multivariate-normal-distribution" class="nav-link" data-scroll-target="#multivariate-normal-distribution"><span class="header-section-number">3.12.4</span> Multivariate normal distribution</a></li>
  <li><a href="#r-commands-for-parametric-distributions" id="toc-r-commands-for-parametric-distributions" class="nav-link" data-scroll-target="#r-commands-for-parametric-distributions"><span class="header-section-number">3.12.5</span> R-commands for parametric distributions</a></li>
  </ul>
</li>
  <li><a href="#additional-reading" id="toc-additional-reading" class="nav-link" data-scroll-target="#additional-reading"><span class="header-section-number">3.13</span> Additional reading</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dependence</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><a href="https://statistics.svenotto.com/section3_dependence.pdf">PDF version</a></p>
<section id="multivariate-random-variables" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="multivariate-random-variables">
<span class="header-section-number">3.1</span> Multivariate random variables</h2>
<p>In statistics, we typically study multiple random variables simultaneously. We can collect <span class="math inline">k</span> random variable <span class="math inline">X_1, \ldots, X_k</span> in a <strong>random vector</strong> <span class="math display">
      X = \begin{pmatrix}
      X_1 \\ \vdots \\ X_k
    \end{pmatrix}=   (X_1, \ldots, X_k)'.
  </span> We also call <span class="math inline">X</span> a <strong><span class="math inline">k</span>-variate random variable</strong>.</p>
<p>Since <span class="math inline">X</span> is a random vector, its outcome is also vector-valued, e.g.&nbsp;<span class="math inline">X = x \in \mathbb R^k</span> with <span class="math inline">x=(x_1, \ldots, x_k)'</span>. Events of the form <span class="math inline">\{X \leq x\}</span> mean that each component of the random vector <span class="math inline">X</span> is smaller than the corresponding values of the vector <span class="math inline">x</span>, i.e. <span class="math display">
\{X \leq x\} = \{X_1 \leq x_1, \ldots, X_k \leq x_k\}.
</span></p>
</section><section id="bivariate-random-variables" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="bivariate-random-variables">
<span class="header-section-number">3.2</span> Bivariate random variables</h2>
<p>If <span class="math inline">k = 2</span>, we call <span class="math inline">X</span> a <strong>bivariate random variable</strong>. Consider, for instance, the coin toss Bernoulli variable <span class="math inline">Y</span> with <span class="math inline">P(Y=1) = 0.5</span> and <span class="math inline">P(Y=0) = 0.5</span>, and let <span class="math inline">Z</span> be a second coin toss with the same probabilities. <span class="math inline">X = (Y,Z)</span> is a bivariate random variable where both entries are discrete random variables. Since the two coin tosses are performed separately from each other, it is reasonable to assume that the probability that the first and second coin tosses show ‘heads’ is 0.25, i.e., <span class="math inline">P(\{Y=1\} \cap \{Z=1\}) = 0.25</span>. We would expect the following joint probabilities:</p>
<div id="tbl-twocoin" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-twocoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: Joint probabilities of coin tosses
</figcaption><div aria-describedby="tbl-twocoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 18%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td><span class="math inline">Z=1</span></td>
<td><span class="math inline">Z=0</span></td>
<td>any result</td>
</tr>
<tr class="even">
<td><span class="math inline">Y=1</span></td>
<td>0.25</td>
<td>0.25</td>
<td>0.5</td>
</tr>
<tr class="odd">
<td><span class="math inline">Y=0</span></td>
<td>0.25</td>
<td>0.25</td>
<td>0.5</td>
</tr>
<tr class="even">
<td>any result</td>
<td>0.5</td>
<td>0.5</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The probabilities in the above table characterize the <strong>joint distribution</strong> of <span class="math inline">Y</span> and <span class="math inline">Z</span>. The table shows the values of the <strong>joint probability mass function</strong>: <span class="math display">
  \pi_{YZ}(a,b) = \begin{cases} 0.25 &amp; \text{if} \ a \in \{0,1\} \ \text{and} \ b \in \{0,1\} \\
  0 &amp; \text{otherwise} \end{cases}
</span> Another example are the random variables <span class="math inline">Y</span>, a dummy variable for the event that the person has a high wage (more than 25 USD/hour), and <span class="math inline">Z</span>, a dummy variable for the event that the same person has a university degree. Similarly, <span class="math inline">X = (Y,Z)</span> is a bivariate random variable consisting of two univariate Bernoulli variables. The joint probabilities might be as follows:</p>
<div id="tbl-wageedu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wageedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.2: Joint probabilities of wage and education dummies
</figcaption><div aria-describedby="tbl-wageedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 23%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>Z=1</td>
<td>Z=0</td>
<td>any education</td>
</tr>
<tr class="even">
<td>Y=1</td>
<td>0.19</td>
<td>0.12</td>
<td>0.31</td>
</tr>
<tr class="odd">
<td>Y=0</td>
<td>0.17</td>
<td>0.52</td>
<td>0.69</td>
</tr>
<tr class="even">
<td>any wage</td>
<td>0.36</td>
<td>0.64</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The joint probability mass function is <span class="math display">
  \pi_{YZ}(a,b) = \begin{cases}
      0.19 &amp; \text{if} \ a=1, b=1, \\
      0.12 &amp; \text{if} \ a=1, b=0, \\
      0.17 &amp; \text{if} \ a=0, b=1, \\
      0.52 &amp; \text{if} \ a=0, b=0, \\
      0   &amp; \text{otherwise.}
  \end{cases}
</span> The <strong>marginal probability mass function</strong> of <span class="math inline">Y</span> is <span class="math display">\begin{align*}
  \pi_Y(a) &amp;= P(Y=a) = \pi_{YZ}(a,0) + \pi_{YZ}(a,1) \\
  &amp;= \begin{cases}
  0.19 + 0.12 = 0.31 &amp; \text{if} \ a = 1, \\
  0.17 + 0.52 = 0.69 &amp; \text{if} \ a = 0, \\
  0 &amp; \text{otherwise.}
  \end{cases}
\end{align*}</span> and the <strong>marginal probability mass function</strong> of <span class="math inline">Z</span> is <span class="math display">\begin{align*}
  \pi_Z(b) &amp;= P(Z=b) = \pi_{YZ}(0,b) + \pi_{YZ}(1,b) \\
  &amp;= \begin{cases}
  0.19 + 0.17 = 0.36 &amp; \text{if} \ b = 1, \\
  0.12 + 0.52 = 0.64 &amp; \text{if} \ b = 0, \\
  0 &amp; \text{otherwise.}
  \end{cases}
\end{align*}</span></p>
<p>An example of a continuous bivariate random variable is <span class="math inline">X = (Y,Z)</span>, where <span class="math inline">Y</span> is the wage level in EUR/hour and <span class="math inline">Z</span> is the labor market experience of the same person measured in years.</p>
</section><section id="bivariate-distributions" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="bivariate-distributions">
<span class="header-section-number">3.3</span> Bivariate distributions</h2>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Bivariate distribution</strong></p>
<p>The <span style="color:orange">joint distribution function</span> of a bivariate random variable <span class="math inline">(Y,Z)</span> is</p>
<p><span class="math inline">F_{YZ}(a, b) = P(Y \leq a, Z \leq b) = P(\{Y \leq a\} \cap \{ Z \leq b\})</span>.</p>
</div>
<div id="fig-jointCDFWageEx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jointCDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-WageExCDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jointCDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Joint CDF of wage and experience
</figcaption></figure>
</div>
<p>Calculation of probabilities using a bivariate distribution function: <span class="math display">\begin{align*}
        P(Y \leq a, Z \leq b) &amp;= F_{YZ}(a,b) \\
        P(a &lt; Y \leq b, c &lt; Z \leq d) &amp;= F_{YZ}(b,d) - F_{YZ}(b,c) - F_{YZ}(a,d) + F_{YZ}(a,c)
\end{align*}</span></p>
<div id="fig-jointCDF1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jointCDF1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-jointCDF1.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jointCDF1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Calculate probabilities using the joint CDF
</figcaption></figure>
</div>
<div id="fig-jointCDF2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jointCDF2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-jointCDF2.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jointCDF2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Calculate probabilities using the joint CDF
</figcaption></figure>
</div>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Marginal distributions</strong></p>
<p>The <span style="color:orange">marginal distributions</span> of <span class="math inline">Y</span> and <span class="math inline">Z</span> are <span class="math display">\begin{align*}
        F_Y(a) = P(Y \leq a) &amp;= P(Y \leq a, Z &lt; \infty) &amp;= \lim_{b \to \infty} F_{YZ}(a,b),\\
        F_Z(b) = P(Z \leq b) &amp;= P(Y &lt; \infty, Z \leq b) &amp;= \lim_{a \to \infty} F_{YZ}(a,b)
\end{align*}</span></p>
</div>
<p><br></p>
<div id="fig-jointCDFWageEx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jointCDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-ExCDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jointCDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Marginal CDF of experience
</figcaption></figure>
</div>
<div id="fig-jointCDFWageEx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jointCDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4CDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jointCDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Marginal CDF of wage
</figcaption></figure>
</div>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Bivariate density function</strong></p>
<p>The <span style="color:orange">joint density function</span> of a bivariate continuous random variable <span class="math inline">(Y,Z)</span> with differentiable joint CDF <span class="math inline">F_{YZ}(a,b)</span> equals <span class="math display">
    f_{YZ}(a,b) = \frac{\partial^2}{\partial a \partial b} F_{YZ}(a,b).
</span></p>
</div>
<p><br></p>
<p>The marginal densities of <span class="math inline">Y</span> and <span class="math inline">Z</span> are <span class="math display">\begin{align*}
f_Y(a) &amp;= \frac{d}{d a} F_Y(a) = \int_{-\infty}^\infty f_{YZ}(a,b)\text{d}b, \\
f_Z(b) &amp;= \frac{d}{d b} F_Z(b) =        \int_{-\infty}^\infty f_{YZ}(a,b)\text{d}a.
\end{align*}</span></p>
<div id="fig-jointCDFWageEx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jointCDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-WageExCDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jointCDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Joint CDF of wage and experience
</figcaption></figure>
</div>
<div id="fig-jointPDFWageEx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jointPDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-WageExPDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jointPDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Joint PDF of wage and experience
</figcaption></figure>
</div>
</section><section id="correlation" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="correlation">
<span class="header-section-number">3.4</span> Correlation</h2>
<p>Consider the bivariate continuous random variable <span class="math inline">(Y,Z)</span> with joint density <span class="math inline">f_{YZ}(a,b)</span>. The expected value of <span class="math inline">g(Y,Z)</span>, where <span class="math inline">g(\cdot, \cdot)</span> is any real-valued function, is given by <span class="math display">
  E[g(X,Y)] = \int_{-\infty}^\infty \int_{-\infty}^\infty g(a,b) f_{YZ}(a,b) \ \text{d}a \ \text{d}b.
</span></p>
<p>The first <strong>cross moment</strong> of <span class="math inline">Y</span> and <span class="math inline">Z</span> is <span class="math inline">E[YZ]</span>. We have <span class="math inline">E[YZ] = E[g(Y,Z)]</span> for the function <span class="math inline">g(Y,Z) = Y\cdot Z</span>. Therefore, <span class="math display">
      E[YZ] = \int_{-\infty}^\infty \int_{-\infty}^\infty ab f_{YZ}(a,b) \ \text{d}a \ \text{d}b.
  </span> The <strong>covariance</strong> of <span class="math inline">Y</span> and <span class="math inline">Z</span> is defined as<br><span class="math display">
   Cov(Y,Z) = E[(Y- E[Y])(Z-E[Z])] = E[YZ] - E[Y]E[Z].
</span> The covariance of <span class="math inline">Y</span> and <span class="math inline">Y</span> is the variance: <span class="math display">
  Cov(Y,Y) = Var[Y].
</span> The variance of the sum of two random variables depends on the covariance: <span class="math display">
  Var[Y+Z] = Var[Y] + 2 Cov(Y,Z) + Var[Z]
</span> The <strong>correlation</strong> of <span class="math inline">Y</span> and <span class="math inline">Z</span> is <span class="math display">
  Corr(Y,Z) = \frac{Cov(Y,Z)}{sd(Y) sd(Z)}
</span></p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Uncorrelated</strong></p>
<p><span class="math inline">Y</span> and <span class="math inline">Z</span> are <strong>uncorrelated</strong> if <span class="math inline">Corr(Y,Z) = 0</span>, or, equivalently, if <span class="math inline">Cov(Y,Z) = 0</span>.</p>
</div>
<p><br></p>
<p>If <span class="math inline">Y</span> and <span class="math inline">Z</span> are uncorrelated, we have <span class="math display">\begin{align*}
        E[YZ] &amp;= E[Y] E[Z] \\
        var[Y+Z] &amp;= var[Y] + var[Z]
\end{align*}</span></p>
</section><section id="independence" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="independence">
<span class="header-section-number">3.5</span> Independence</h2>
<p>Two events <span class="math inline">A</span> and <span class="math inline">B</span> are independent if <span class="math display">
        P[A \cap B] = P[A] P[B].
</span> For instance, in the bivariate random variable of <a href="#tbl-twocoin" class="quarto-xref">Table&nbsp;<span>3.1</span></a> (two coin tosses), we have <span class="math display">P(Y=1, Z=1) = 0.25 = 0.5 \cdot 0.5 = P(Y=1)P(Z=1).</span> Hence, <span class="math inline">\{Y=1\}</span> and <span class="math inline">\{Z=1\}</span> are independent events. In the bivariate random variable of <a href="#tbl-wageedu" class="quarto-xref">Table&nbsp;<span>3.2</span></a> (wage/education), we find <span class="math display">P(Y=1, Z=1) = 0.19 \neq P(Y=1)P(Z=1) = 0.31 \cdot 0.36 = 0.1116.</span> Therefore, the two events are not independent. In this case, the two random variables are dependent.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Independence</strong></p>
<p><span class="math inline">Y</span> and <span class="math inline">Z</span> are <strong>independent</strong> random variables if, for all <span class="math inline">a</span> and <span class="math inline">b</span>, the bivariate distribution function is the product of the marginal distribution functions: <span class="math display">
        F_{YZ}(a,b) = F_Y(a) F_Z(b).
    </span> If this property is not satisfied, we say that <span class="math inline">X</span> and <span class="math inline">Y</span> are <strong>dependent</strong>.</p>
</div>
<p><br></p>
<p>The random variables <span class="math inline">Y</span> and <span class="math inline">Z</span> of <a href="#tbl-twocoin" class="quarto-xref">Table&nbsp;<span>3.1</span></a> are independent, and those of <a href="#tbl-wageedu" class="quarto-xref">Table&nbsp;<span>3.2</span></a> are dependent.</p>
<p>If <span class="math inline">Y</span> and <span class="math inline">Z</span> are independent and have finite second moments, then <span class="math inline">Y</span> and <span class="math inline">Z</span> are uncorrelated. The reverse is not true!</p>
</section><section id="random-vectors" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="random-vectors">
<span class="header-section-number">3.6</span> Random vectors</h2>
<p>The above concepts can be generalized to any <span class="math inline">k</span>-variate random vector <span class="math inline">X = (X_1, \ldots, X_k)</span>. The joint CDF of <span class="math inline">X</span> is <span class="math display">
    F_X(x) = P(X_1 \leq x_1, \ldots, X_k \leq x_k).
</span> <span class="math inline">X</span> has independent entries if <span class="math display">
        F_X(x) = \prod_{i=1}^k P(X_i \leq x_i) = \prod_{i=1}^k F_{X_i}(x_i)
    </span> If <span class="math inline">F_X(x)</span> is a continuous CDF, the joint <span class="math inline">k</span>-dimensional density is <span class="math display">
    f_X(x) = f_X(x_1, \ldots, x_k) = \frac{\partial^k}{\partial x_1 \cdots \partial x_k} F_X(x_1, \ldots ,x_k).
  </span></p>
<p>The expectation vector of <span class="math inline">X</span> is <span class="math display">
        E[X] = \begin{pmatrix} E[X_1] \\  \vdots \\ E[X_k] \end{pmatrix},
    </span> and the covariance matrix of <span class="math inline">X</span> is <span class="math display">\begin{align*}
Var[X] &amp;= E[(X-E[X])(X-E[X])'] \\
      &amp;= \begin{pmatrix}
            Var[X_1] &amp; Cov(X_1, X_2) &amp; \ldots &amp; Cov(X_1, X_k) \\
            Cov(X_2, X_1) &amp; Var[X_2] &amp; \ldots &amp; Cov(X_2, X_k) \\
            \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
            Cov(X_k, X_1) &amp; Cov(X_k, X_2) &amp; \ldots &amp; Var[X_k]
        \end{pmatrix}
\end{align*}</span></p>
<p>For any random vector <span class="math inline">X</span>, the covariance matrix <span class="math inline">Var[X]</span> is symmetric and positive semi-definite.</p>
</section><section id="conditional-distributions" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="conditional-distributions">
<span class="header-section-number">3.7</span> Conditional distributions</h2>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Conditional probability</strong></p>
<p>The conditional probability of an event <span class="math inline">A</span> given an event <span class="math inline">B</span> with <span class="math inline">P(B) &gt; 0</span> is <span class="math display">
  P(A \mid B) = \frac{P(A \cap B)}{P(B)}
</span></p>
</div>
<p><br></p>
<p>Let’s revisit the wage and schooling example from <a href="#tbl-wageedu" class="quarto-xref">Table&nbsp;<span>3.2</span></a>: <span class="math display">
     P(Y=1 \mid Z=1) = \frac{P(\{Y=1\}\cap \{Z=1\})}{P(Z=1)} = \frac{0.19}{0.36} = 0.53
    </span> <span class="math display">
     P(Y=1 \mid Z=0) = \frac{P(\{Y=1\}\cap \{Z=0\})}{P(Z=0)} = \frac{0.12}{0.64} = 0.19
    </span></p>
<p>Note that <span class="math display">
P(Y=1 \mid Z=1) = 0.53 &gt; 0.31 = P(Y=1)
</span> implies <span class="math display">
P(\{Y=1\}\cap \{Z=1\}) &gt; P(Y=1) \cdot P(Z=1).
</span> If <span class="math inline">P(A \mid B) = P(A)</span>, then the events <span class="math inline">A</span> and <span class="math inline">B</span> are independent. If <span class="math inline">P(A \mid B) \neq P(A)</span>, they are dependent.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Conditional distribution of continuous variables</strong></p>
<p>Consider the density <span class="math inline">f_{YZ}(a,b)</span> of two continuous random variables <span class="math inline">Y</span> and <span class="math inline">Z</span>. The <strong>conditional density</strong> of <span class="math inline">Y</span> given <span class="math inline">Z=b</span> is <span class="math display">
        f_{Y|Z}(a \mid b) = \frac{f_{YZ}(a,b)}{f_Z(b)}.
</span> The <strong>conditional distribution</strong> of <span class="math inline">Y</span> given <span class="math inline">Z=b</span> is <span class="math display">
    F_{Y|Z}(a \mid b)  = \int_0^a f_{Y|Z}(u \mid b) \ \text{d}u.
</span></p>
</div>
<p><br></p>
<div id="fig-jointPDFWageEx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-jointPDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-WageExPDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jointPDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Joint PDF of wage and experience
</figcaption></figure>
</div>
<div id="fig-condPDFWageEx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condPDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-WageExCondPDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-condPDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.9: Conditional PDFs of wage given experience
</figcaption></figure>
</div>
<div id="fig-condPDFWageEx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condPDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-ExPDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-condPDFWageEx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.10: PDF of variable experience
</figcaption></figure>
</div>
<p>If <span class="math inline">Y</span> is continuous and <span class="math inline">Z</span> is discrete, the <strong>conditional distribution function</strong> of <span class="math inline">Y</span> given <span class="math inline">\{Z=b\}</span> with <span class="math inline">P(Z=b) &gt; 0</span> is <span class="math display">
      F_{Y|Z}(a \mid b) = P(Y \leq a \mid Z=b) = \frac{P(Y \leq a, Z=b)}{P(Z=b)}.
  </span></p>
<p>If <span class="math inline">F_{Y|Z}(a \mid b)</span> is differentiable with respect to <span class="math inline">b</span>, the <strong>conditional density</strong> of <span class="math inline">Y</span> given <span class="math inline">Z=b</span> is <span class="math display">
        f_{Y|Z}(a \mid b) = \frac{\partial}{\partial a} F_{Y|Z}(a \mid b).
    </span></p>
<div id="fig-condCDFWageEdu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condCDFWageEdu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-CondCFDWageEdu.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-condCDFWageEdu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.11: Conditional CDFs of wage given education
</figcaption></figure>
</div>
<div id="fig-condCDFWageEdu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condCDFWageEdu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec03-CondPDFWageEdu.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-condCDFWageEdu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.12: Conditional PDFs of wage given education
</figcaption></figure>
</div>
<p>We often are interested in conditioning on multiple variables, such as the wage given a particular education and experience level. Let <span class="math inline">f(y,x) = f(y,x_1, \ldots, x_k)</span> be the joint density of the composite random vector <span class="math inline">(Y, X_1, \ldots, X_k)</span> with <span class="math inline">X = (X_1, \ldots, X_k)</span>. The conditional density of a random variable <span class="math inline">Y</span> given <span class="math inline">X = x = (x_1, \ldots, x_k)'</span> is <span class="math display">
        f_{Y|X}(y \mid x) = f(y \mid x_1, \ldots, x_k) = \frac{f(y, x_1, \ldots, x_k)}{f_X(x_1, \ldots, x_k)} = \frac{f(y,x)}{f_X(x)}
    </span> The conditional distribution of <span class="math inline">Y</span> given <span class="math inline">X=x</span> is <span class="math display">
        F_{Y|X}(y\mid x) = \int_0^y f(u \mid x)\ \text{d}u.
    </span></p>
</section><section id="conditional-expectation" class="level2" data-number="3.8"><h2 data-number="3.8" class="anchored" data-anchor-id="conditional-expectation">
<span class="header-section-number">3.8</span> Conditional expectation</h2>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Conditional expectation function</strong></p>
<p>The <strong>conditional expectation</strong> of <span class="math inline">Y</span> given <span class="math inline">X=x</span> is the expected value of the distribution <span class="math inline">F_{Y|X}(y \mid x)</span>. For continuous <span class="math inline">Y</span> with conditional density <span class="math inline">f_{Y|X}(y \mid x)</span>, the conditional expectation is</p>
<p><span class="math display">
    E[Y \mid X=x] = \int_{-\infty}^\infty y f_{Y|X}(y \mid x)\ \text{d}y.
</span></p>
</div>
<p><br></p>
<div id="fig-cef" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-cef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cef" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-CEF1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-CEF1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img_zusatz/fig-Conditionalexpectation-1.png" class="img-fluid figure-img" data-ref-parent="fig-cef">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-CEF1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) CEF wage given experience
</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-cef" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-CEF2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-CEF2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img_zusatz/fig-Conditionalexpectation-2.png" class="img-fluid figure-img" data-ref-parent="fig-cef">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-CEF2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) CEF wage given education
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.13: Conditional expectation functions
</figcaption></figure>
</div>
<p>Consider again the wage and experience example. Suppose that the conditional expectation has the functional form <span class="math display">
    E[wage \mid experience = x ] = m(x) = 14.5 + 0.9 x - 0.017 x^2.
</span> E.g., for <span class="math inline">x=10</span> we have <span class="math inline">E[wage \mid experience = 10] = m(10) = 21.8</span>.</p>
<p>Note that <span class="math inline">m(x) = E[wage \mid experience = x]</span> is not random. It is a feature of the joint distribution.</p>
<p>Sometimes, it is useful not to fix the experience level to a certain value but to treat it as random:</p>
<p><span class="math display">\begin{align*}
      E[wage \mid experience] &amp;= m(experience) \\
      &amp;= 14.5 + 0.9 experience - 0.017 experience^2
\end{align*}</span></p>
<p><span class="math inline">m(experience) = E[wage \mid experience]</span> is a function of the random variable experience and, therefore, itself a random variable.</p>
<p>The <span style="color:blue">conditional expectation function (CEF) of <span class="math inline">Y</span> given the specific event <span class="math inline">\{X=x\}</span></span> is <span class="math display">
      m(x) = E[Y \mid X=x].
  </span> <span class="math inline">m(x)</span> is deterministic (non-random) and a feature of the joint distribution.</p>
<p>The <span style="color:blue">conditional expectation function (CEF) of <span class="math inline">Y</span> given the random vector <span class="math inline">X</span></span> is <span class="math display">
      m(X) = E[Y \mid X].
  </span> <span class="math inline">m(X)</span> is a function of the random vector <span class="math inline">X</span> and therefore itself a random variable.</p>
</section><section id="law-of-iterated-expectations" class="level2" data-number="3.9"><h2 data-number="3.9" class="anchored" data-anchor-id="law-of-iterated-expectations">
<span class="header-section-number">3.9</span> Law of iterated expectations</h2>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Rules of calculation for the conditional expectation </strong></p>
<p>Let <span class="math inline">Y</span> be a random variable and <span class="math inline">X</span> a random vector.</p>
<ol type="i">
<li><p><span style="color:blue">Law of the iterated expectations (LIE)</span>: <span class="math display">
E[E[Y \mid X]] = E[Y].
  </span> A more general LIE: For any two random vectors <span class="math inline">X</span> and <span class="math inline">\widetilde X</span>, <span class="math display">
  E[E[Y \mid X, \widetilde X] \mid X] = E[Y \mid X].
  </span></p></li>
<li><p><span style="color:blue">Conditioning theorem (CT)</span>: For any function <span class="math inline">g(\cdot)</span>, <span class="math display">
E[g(X) Y \mid X] = g(X) E[Y \mid X].
  </span></p></li>
<li><p>If <span class="math inline">Y</span> and <span class="math inline">X</span> are independent then <span class="math inline">E[Y \mid X] = E[Y]</span>.</p></li>
</ol>
</div>
</section><section id="conditional-variance" class="level2" data-number="3.10"><h2 data-number="3.10" class="anchored" data-anchor-id="conditional-variance">
<span class="header-section-number">3.10</span> Conditional variance</h2>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Conditional variance</strong></p>
<p>If <span class="math inline">E[Y^2] &lt; \infty</span>, the <strong>conditional variance</strong> of <span class="math inline">Y</span> given the event <span class="math inline">\{X=x\}</span> is <span class="math display">
            Var[Y \mid X=x] = E[(Y-E[Y \mid X=x])^2 \mid X=x].
        </span></p>
<p>The conditional variance of <span class="math inline">Y</span> given the random vector <span class="math inline">X</span> is <span class="math display">
    Var[Y \mid X] = E[(Y-E[Y \mid X])^2 \mid X].
</span></p>
</div>
</section><section id="best-predictor" class="level2" data-number="3.11"><h2 data-number="3.11" class="anchored" data-anchor-id="best-predictor">
<span class="header-section-number">3.11</span> Best predictor</h2>
<p>A typical application is to find a good prediction for the outcome of a random variable <span class="math inline">Y</span>. Recall that the expected value <span class="math inline">E[Y]</span> is the best predictor for <span class="math inline">Y</span> in the sense that <span class="math inline">g^* = E[Y]</span> minimizes <span class="math inline">E[(Y-g)^2]</span>.</p>
<p>With the knowledge of an additional random vector <span class="math inline">X</span>, we can use the joint distribution of <span class="math inline">Y</span> and <span class="math inline">X</span> to improve the prediction of <span class="math inline">Y</span>.</p>
<p>It turns out that the CEF <span class="math inline">m(X) = E[Y \mid X]</span> is the best predictor for <span class="math inline">Y</span> given the information contained in the random vector <span class="math inline">X</span>:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Best predictor</strong></p>
<p>If <span class="math inline">E[Y^2] &lt; \infty</span>, then the CEF <span class="math inline">m(X) = E[Y \mid X]</span> minimizes the expected squared error <span class="math inline">E[(Y-g(X))^2]</span> among all predictor functions <span class="math inline">g(X)</span>.</p>
</div>
<p><br></p>
<p>Let us find the function <span class="math inline">g(\cdot)</span> that minimizes <span class="math inline">E[(Y-g(X))^2]</span>:</p>
<p><span class="math display">\begin{align*}
        &amp;E[(Y-g(X))^2] = E[(Y-m(X) + m(X) - g(X))^2] \\
        &amp;= \underbrace{E[(Y-m(X))^2]}_{=(i)} + 2\underbrace{E[(Y-m(X))(m(X) - g(X))]}_{=(ii)} + \underbrace{E[(m(X) - g(X))^2]}_{(iii)}
\end{align*}</span></p>
<p>The first term (i) does not depend on <span class="math inline">g(\cdot)</span> and is finite if <span class="math inline">E[Y^2] &lt; \infty</span>.</p>
<p>For the second term (ii), we use the LIE and CT: <span class="math display">\begin{align*}
        &amp;E[(Y-m(X))(m(X) - g(X))] \\
        &amp;= E[E[(Y-m(X))(m(X) - g(X))\mid X]] \\
        &amp;= E[E[Y-m(X)\mid X](m(X) - g(X))] \\
        &amp;= E[(\underbrace{E[Y\mid X]}_{=m(X)} - m(X))(m(X) - g(X))] = 0
\end{align*}</span></p>
<p>The third term (iii) <span class="math inline">E[(m(X) - g(X))^2]</span> is minimal if <span class="math inline">m(\cdot) = g(\cdot)</span></p>
<p>Therefore, <span class="math inline">m(X) = E[Y\mid X]</span> minimizes <span class="math inline">E[(Y-g(X))^2]</span>.</p>
<p>The best predictor for <span class="math inline">Y</span> given <span class="math inline">X</span> is <span class="math inline">m(X)= E[Y \mid X]</span>, but <span class="math inline">Y</span> can typically only partially be predicted. We have a prediction error (CEF error) <span class="math display">
        e = Y - E[Y \mid X].
    </span> The conditional expectation of the CEF error does not depend on <span class="math inline">X</span> and is zero: <span class="math display">\begin{align*}
        E[e \mid X] &amp;= E[(Y - m(X)) \mid X] \\
        &amp;= E[Y \mid X] - E[m(X) \mid X] \\
        &amp;= m(X) - m(X) = 0
\end{align*}</span></p>
<p>We say that <span class="math inline">Y</span> is <strong>conditional mean independent</strong> of <span class="math inline">Z</span> if <span class="math inline">E[Y \mid Z]</span> does not depend on <span class="math inline">Z</span>.</p>
<p>If <span class="math inline">Y</span> and <span class="math inline">Z</span> are independent, they are also conditional mean independent, but not necessarily vice versa. If <span class="math inline">Y</span> and <span class="math inline">Z</span> are conditional mean independent, they are also uncorrelated, but not necessarily vice versa.</p>
<p>Since the CEF is the best predictor of Y, it is of great interest to study the CEF in practice. Much of the statistical and econometric research deals with methods to approximate and estimate the CEF. This field of statistics is called <strong>regression analysis</strong>.</p>
<p>Consider the following model for <span class="math inline">Y</span> and <span class="math inline">X</span>: <span id="eq-cef"><span class="math display">
    Y = m(X) + e, \quad E[e \mid X] = 0.
   \tag{3.1}</span></span> We call <span class="math inline">m(\cdot)</span> <strong>regression function</strong> and <span class="math inline">e</span> <strong>error term</strong>.</p>
<p>From equation <a href="#eq-cef" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> it follows that <span class="math display">
    E[Y \mid X] = E[m(X) + e \mid X] = E[m(X) \mid X] + E[e \mid X] = m(X).
    </span> I.e., the nonparametric regression model is a model for the CEF.</p>
<p>If <span class="math inline">m(\cdot)</span> is a linear function, then <a href="#eq-cef" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> is a <strong>linear regression model</strong>. We will study this model in detail in the next sections.</p>
</section><section id="combining-normal-variables" class="level2" data-number="3.12"><h2 data-number="3.12" class="anchored" data-anchor-id="combining-normal-variables">
<span class="header-section-number">3.12</span> Combining normal variables</h2>
<p>Some of the distributions commonly encountered in econometrics are combinations of univariate normal distributions, such as the multivariate normal, chi-squared, Student t, and F distributions.</p>
<section id="chi2-distribution" class="level3" data-number="3.12.1"><h3 data-number="3.12.1" class="anchored" data-anchor-id="chi2-distribution">
<span class="header-section-number">3.12.1</span> <span class="math inline">\chi^2</span>-distribution</h3>
<p>Let <span class="math inline">Z_1, \ldots, Z_m</span> be independent <span class="math inline">\mathcal N(0,1)</span> random variables. Then, the random variable <span class="math display">
        Y = \sum_{i=1}^m Z_i^2
  </span> is <strong>chi-square distributed</strong> with parameter <span class="math inline">m</span>, written <span class="math inline">Y \sim \chi^2_m</span>.</p>
<p>The parameter <span class="math inline">m</span> is called the degrees of freedom.</p>
<p>Expectation and variance: <span class="math display">
        E[Y] = m, \quad var[Y] = 2m
    </span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-chisquare" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-chisquare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sec03_dependence_files/figure-html/fig-chisquare-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chisquare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.14: <span class="math inline">\chi^2</span> -distribution
</figcaption></figure>
</div>
</div>
</div>
</section><section id="f-distribution" class="level3" data-number="3.12.2"><h3 data-number="3.12.2" class="anchored" data-anchor-id="f-distribution">
<span class="header-section-number">3.12.2</span> <span class="math inline">F</span>-distribution</h3>
<p>If <span class="math inline">Q_1 \sim \chi^2_m</span> and <span class="math inline">Q_2 \sim \chi^2_r</span>, and if <span class="math inline">Q_1</span> and <span class="math inline">Q_2</span> are independent, then <span class="math display">
        Y = \frac{Q_1/m}{Q_2/r}
    </span> is <strong><span class="math inline">F</span>-distributed</strong> with parameters <span class="math inline">m</span> and <span class="math inline">r</span>, written <span class="math inline">Y \sim F_{m,r}</span>.</p>
<p>The parameter <span class="math inline">m</span> is called the degrees of freedom in the numerator; <span class="math inline">r</span> is the degree of freedom in the denominator.</p>
<p>If <span class="math inline">r \to \infty</span> then the distribution of <span class="math inline">mY</span> approaches <span class="math inline">\chi^2_m</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fdistribution" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-fdistribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sec03_dependence_files/figure-html/fig-fdistribution-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fdistribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.15: <span class="math inline">F</span>-distribution
</figcaption></figure>
</div>
</div>
</div>
</section><section id="student-t-distribution" class="level3" data-number="3.12.3"><h3 data-number="3.12.3" class="anchored" data-anchor-id="student-t-distribution">
<span class="header-section-number">3.12.3</span> Student <span class="math inline">t</span>-distribution</h3>
<p>If <span class="math inline">Z \sim \mathcal N(0,1)</span> and <span class="math inline">Q \sim \chi^2_m</span>, and <span class="math inline">Z</span> and <span class="math inline">Q</span> are independent, then <span class="math display">
        Y = \frac{Z}{\sqrt{Q/m}}
    </span> is <strong><span class="math inline">t</span>-distributed</strong> with parameter <span class="math inline">m</span> degrees of freedom, written <span class="math inline">Y \sim t_m</span>.</p>
<p>Expectation, variance, and moments: <span class="math display">
        E[Y] = 0 \quad  (\text{if} \ m \geq 2),
    </span> <span class="math display">
        var[Y] = \frac{m}{m-2} \quad (\text{if} \ m \geq 3)
    </span> The first <span class="math inline">m-1</span> moments are finite: <span class="math inline">E[|Y|^r] &lt; \infty</span> for <span class="math inline">r \leq m-1</span> and <span class="math inline">E[|Y|^r] = \infty</span> for <span class="math inline">r \geq m</span>.</p>
<p>The <span class="math inline">t</span>-distribution with <span class="math inline">m=1</span> is also called <strong>Cauchy distribution</strong>. The <span class="math inline">t</span>-distributions with 1, 2, 3, and 4 degrees of freedom are heavy-tailed distributions. If <span class="math inline">m \to \infty</span> then <span class="math inline">t_m \to \mathcal N(0,1)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-studentt" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-studentt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="sec03_dependence_files/figure-html/fig-studentt-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-studentt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.16: Student <span class="math inline">t</span>-distribution
</figcaption></figure>
</div>
</div>
</div>
</section><section id="multivariate-normal-distribution" class="level3" data-number="3.12.4"><h3 data-number="3.12.4" class="anchored" data-anchor-id="multivariate-normal-distribution">
<span class="header-section-number">3.12.4</span> Multivariate normal distribution</h3>
<p>Let <span class="math inline">X_1, \ldots, X_k</span> be independent <span class="math inline">\mathcal N(0,1)</span> random variables. Then, the <span class="math inline">k</span>-vector <span class="math inline">X = (X_1, \ldots, X_k)'</span> has the <strong>multivariate standard normal distribution</strong>, written <span class="math inline">X \sim \mathcal N(\boldsymbol 0, \boldsymbol I_k)</span>. Its joint density is <span class="math display">
        f(x) = \frac{1}{(2 \pi)^{k/2}} \exp\left( - \frac{x'x}{2} \right).
    </span></p>
<p>If <span class="math inline">X \sim \mathcal N(\boldsymbol 0, \boldsymbol I_k)</span> and <span class="math inline">\widetilde X = \mu + \boldsymbol B X</span> for a <span class="math inline">q \times 1</span> vector <span class="math inline">\mu</span> and a <span class="math inline">q \times k</span> matrix <span class="math inline">\boldsymbol B</span>, then <span class="math inline">\widetilde X</span> has a <strong>multivariate normal distribution</strong> with parameters <span class="math inline">\mu</span> and <span class="math inline">\Sigma = \boldsymbol B \boldsymbol B'</span>, written <span class="math inline">\widetilde X \sim \mathcal N(\mu, \Sigma)</span>. Its joint density is <span class="math display">
        f(x) = \frac{1}{(2 \pi)^{k/2} (\det(\Sigma))^{1/2} } \exp\Big(- \frac{1}{2}(x-\mu)'\Sigma^{-1} (x-\mu) \Big).
</span></p>
<p>The expectation vector and covariance matrix are <span class="math display">
        E[\widetilde X] = \mu, \quad var[\widetilde X] = \Sigma.
    </span></p>
</section><section id="r-commands-for-parametric-distributions" class="level3" data-number="3.12.5"><h3 data-number="3.12.5" class="anchored" data-anchor-id="r-commands-for-parametric-distributions">
<span class="header-section-number">3.12.5</span> R-commands for parametric distributions</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 27%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>get CDF<br><span class="math inline">F(a)</span>
</th>
<th>quantile function<br><span class="math inline">q(p)</span>
</th>
<th>generate <span class="math inline">n</span> independent<br>
random numbers</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\mathcal N(0,1)</span></td>
<td><code>pnorm(a)</code></td>
<td><code>qnorm(p)</code></td>
<td><code>rnorm(n)</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\chi^2_r</span></td>
<td><code>pchisq(a,r)</code></td>
<td><code>qchisq(p,r)</code></td>
<td><code>rchisq(n,r)</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">t_r</span></td>
<td><code>pt(a,r)</code></td>
<td><code>qt(p,r)</code></td>
<td><code>rt(n,r)</code></td>
</tr>
<tr class="even">
<td><span class="math inline">F_{r,k}</span></td>
<td><code>pf(a,r,k)</code></td>
<td><code>qf(p,r,k)</code></td>
<td><code>rf(n,r,k)</code></td>
</tr>
</tbody>
</table></section></section><section id="additional-reading" class="level2" data-number="3.13"><h2 data-number="3.13" class="anchored" data-anchor-id="additional-reading">
<span class="header-section-number">3.13</span> Additional reading</h2>
<ul>
<li>Stock and Watson (2019), Section 2</li>
<li>Hansen (2022a), Section 4</li>
<li>Hansen (2022b), Section 2</li>
<li>Davidson and MacKinnon (2004), Section 1</li>
</ul>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./sec02_probability.html" class="pagination-link" aria-label="Probability">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat1_data.html" class="pagination-link" aria-label="Data">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>