<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>5&nbsp; Probability – Probability Theory for Econometricians</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat4_expectation.html" rel="next">
<link href="./stat1_data.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="5&nbsp; Probability – Probability Theory for Econometricians">
<meta property="og:description" content="">
<meta property="og:site_name" content="Probability Theory for Econometricians">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat3_probability.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Probability Theory for Econometricians</a> 
        <div class="sidebar-tools-main">
    <a href="./Probability-Theory-for-Econometricians.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part1_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec02_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec03_dependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dependence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat1_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat3_probability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat4_expectation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Expectated value</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat5_conditional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Conditional expectation</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#random-sampling" id="toc-random-sampling" class="nav-link active" data-scroll-target="#random-sampling"><span class="header-section-number">5.1</span> Random Sampling</a></li>
  <li><a href="#random-variables" id="toc-random-variables" class="nav-link" data-scroll-target="#random-variables"><span class="header-section-number">5.2</span> Random variables</a></li>
  <li><a href="#events-and-probabilities" id="toc-events-and-probabilities" class="nav-link" data-scroll-target="#events-and-probabilities"><span class="header-section-number">5.3</span> Events and probabilities</a></li>
  <li><a href="#probability-function" id="toc-probability-function" class="nav-link" data-scroll-target="#probability-function"><span class="header-section-number">5.4</span> Probability function</a></li>
  <li><a href="#distribution-function" id="toc-distribution-function" class="nav-link" data-scroll-target="#distribution-function"><span class="header-section-number">5.5</span> Distribution function</a></li>
  <li><a href="#probability-mass-function" id="toc-probability-mass-function" class="nav-link" data-scroll-target="#probability-mass-function"><span class="header-section-number">5.6</span> Probability mass function</a></li>
  <li><a href="#probability-density-function" id="toc-probability-density-function" class="nav-link" data-scroll-target="#probability-density-function"><span class="header-section-number">5.7</span> Probability density function</a></li>
  <li><a href="#conditional-distribution" id="toc-conditional-distribution" class="nav-link" data-scroll-target="#conditional-distribution"><span class="header-section-number">5.8</span> Conditional distribution</a></li>
  <li><a href="#independence-of-random-variables" id="toc-independence-of-random-variables" class="nav-link" data-scroll-target="#independence-of-random-variables"><span class="header-section-number">5.9</span> Independence of random variables</a></li>
  <li><a href="#independence-of-random-vectors" id="toc-independence-of-random-vectors" class="nav-link" data-scroll-target="#independence-of-random-vectors"><span class="header-section-number">5.10</span> Independence of random vectors</a></li>
  <li><a href="#r-codes" id="toc-r-codes" class="nav-link" data-scroll-target="#r-codes"><span class="header-section-number">5.11</span> R-codes</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><a href="https://statistics.svenotto.com/section4_probability.pdf">PDF version</a></p>
<section id="random-sampling" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="random-sampling">
<span class="header-section-number">5.1</span> Random Sampling</h2>
<p>From an empirical perspective, a dataset <span class="math inline">Y_1, \ldots, Y_n</span> or <span class="math inline">\boldsymbol X_1, \ldots, \boldsymbol X_n</span> is just a fixed array of numbers. Any summary statistic we compute – like a sample mean, sample correlation, or OLS coefficient – is simply a function of these numbers.</p>
<p>These statistics provide a snapshot of the data at hand but do not automatically reveal broader insights about the world. To add deeper meaning to these numbers, identify dependencies, and understand causalities, we must consider how the data were obtained.</p>
<p>A <strong>random experiment</strong> is an experiment whose outcome cannot be predicted with certainty. In statistical theory, any dataset is viewed as the result of such a random experiment.</p>
<p>The gender of the next person you meet, daily fluctuations in stock prices, monthly music streams of your favorite artist, or the annual number of pizzas consumed – all involve a certain amount of randomness and emerge from random experiments.</p>
<p>Sampling is the process of drawing observations from a population. Hence, a dataset is also called a <strong>sample</strong>. Each summary statistic, such as a sample mean or OLS coefficient, is one possible outcome of the random experiment. Repeating the experiment produces a new sample and new statistics.</p>
<p>In statistical theory, the <strong>population</strong> from which we draw observations is treated as infinite. It serves as a theoretical construct that includes not only existing members of a physical population, but all possible future or hypothetical individuals. In coin flip studies, for example, the infinite population represents not just all coin flips ever performed, but all possible coin flips that could theoretically occur in any context at any time.</p>
<p>The goal of <strong>statistical inference</strong> is to learn about the world from the observed sample. This requires assumptions about how the data were collected.</p>
<p>The simplest ideal assumption is <strong>random sampling</strong>, where each observation is drawn independently from the population – like drawing balls from an urn or randomly selecting survey participants. This principle is often called <strong>i.i.d. sampling</strong> (independent and identically distributed sampling). To define these concepts rigorously, we rely on <strong>probability theory</strong>.</p>
</section><section id="random-variables" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="random-variables">
<span class="header-section-number">5.2</span> Random variables</h2>
<p>A <strong>random variable</strong> is a numerical summary of a random experiment. An <strong>outcome</strong> is a specific result of a random experiment. The <strong>sample space</strong> <span class="math inline">S</span> is the set/collection of all potential outcomes.</p>
<p>Let’s consider some examples:</p>
<ul>
<li>
<em>Coin toss:</em> The outcome of a coin toss can be “heads” or “tails”. This random experiment has a two-element sample space: <span class="math inline">S = \{heads, tails\}</span>. We can express the experiment as a binary random variable: <span class="math display">
Y = \begin{cases}
1   &amp; \text{if outcome is heads,} \\
0   &amp; \text{if outcome is tails.}
\end{cases}
</span>
</li>
<li>
<em>Gender:</em> If you conduct a survey and interview a random person to ask them about their gender, the answer may be “female”, “male”, or “diverse”. It is a random experiment since the person to be interviewed is selected randomly. The sample space has three elements: <span class="math inline">S = \{female, male, diverse\}</span>. To focus on female vs.&nbsp;non-female, we can define the female dummy variable: <span class="math display">
Y = \begin{cases}
1   &amp; \text{if the person is female,} \\
0   &amp; \text{if the person is not female.}
\end{cases}
</span> Similarly, dummy variables for <em>male</em> and <em>diverse</em> can be defined.</li>
<li>
<em>Education level:</em> If you ask a random person about their education level according to the <a href="https://en.wikipedia.org/wiki/International_Standard_Classification_of_Education">ISCED-2011 framework</a>, the outcome may be one of the eight ISCED-2011 levels. We have an eight-element sample space: <span class="math display">S = \{Level \ 1, Level \ 2, Level \ 3, Level \ 4, Level \ 5, Level \ 6, Level \ 7, Level \ 8\}.</span> The eight-element sample space of the education-level random experiment provides a natural ordering. We define the random variable <em>education</em> as the number of years of schooling of the interviewed person: <span class="math display">
Y = \text{years of schooling} \in \{4, 10, 12, 13, 14, 16, 18, 21\}.
</span>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div id="tbl-ISCED" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ISCED-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.1: ISCED 2011 levels
</figcaption><div aria-describedby="tbl-ISCED-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">ISCED level</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Education level</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Years of schooling</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">Primary</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">Lower Secondary</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">Upper secondary</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">Post-Secondary</td>
<td style="text-align: center;">13</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">Short-Cycle Tertiary</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">Bachelor's</td>
<td style="text-align: center;">16</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">Master's</td>
<td style="text-align: center;">18</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">Doctoral</td>
<td style="text-align: center;">21</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<ul>
<li>
<em>Wage</em>: If you ask a random person about their income per working hour in EUR, there are infinitely many potential answers. Any (non-negative) real number may be an outcome. The sample space is a continuum of different wage levels. The wage level of the interviewed is already numerical. The random variable is <span class="math display">
Y = \text{income per working hour in EUR}.
</span>
</li>
</ul>
<!-- These random variables have in common that they take values on the real line $\mathbb R$ but their outcome is uncertain before conducting the random experiment (i.e. flipping the coin or selecting a random person to be interviewed). --><p>Random variables share the characteristic that their value is uncertain before conducting a random experiment (e.g., flipping a coin or selecting a random person for an interview). Their value is always a real number and is determined only once the experiment’s outcome is known.</p>
</section><section id="events-and-probabilities" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="events-and-probabilities">
<span class="header-section-number">5.3</span> Events and probabilities</h2>
<p>An <strong>event</strong> of a random variable <span class="math inline">Y</span> is a specific subset of the real line. Any real number defines an event (elementary event), and any open, half-open, or closed interval represents an event as well.</p>
<p>Let’s define some specific events:</p>
<ul>
<li>Elementary events: <span class="math display">
  A_1 = \{Y=0\}, \quad A_2 = \{Y=1\}, \quad A_3 = \{Y=2.5\}
</span>
</li>
<li>Half-open events: <span class="math display">\begin{align*}
A_4 &amp;= \{Y \geq 0\} = \{ Y \in [0,\infty) \} \\
A_5 &amp;= \{ -1 \leq Y &lt; 1 \} = \{ Y \in [-1,1) \}.
\end{align*}</span>
</li>
</ul>
<p>The <strong>probability function</strong> <span class="math inline">P</span> assigns values between 0 and 1 to events. For a fair coin toss it is natural to assign the following probabilities: <span class="math display">
  P(A_1) = P(Y=0) = 0.5, \quad P(A_2) = P(Y=1) = 0.5
</span> By definition, the coin variable will never take the value 2.5, so we assign <span class="math display">
  P(A_3) = P(Y=2.5) = 0.
</span> To assign probabilities to interval events, we check whether the events <span class="math inline">\{Y=0\}</span> and/or <span class="math inline">\{Y=1\}</span> are subsets of the event of interest.</p>
<p>If both <span class="math inline">\{Y=0\}</span> and <span class="math inline">\{Y=1\}</span> are contained in the event of interest, the probability is 1. If only one of them is contained, the probability is 0.5. If neither is contained, the probability is 0. <span class="math display">
  P(A_4) = P(Y \geq 0) = 1, \quad P(A_5) = P( -1 \leq Y &lt; 1) = 0.5.
</span></p>
<p>Every event has a <strong>complementary event</strong>, and for any pair of events we can take the <strong>union</strong> and <strong>intersection</strong>. Let’s define further events:</p>
<ul>
<li>Complements: <span class="math display">
A_6 = A_4^c = \{Y \geq 0\}^c = \{ Y &lt; 0\} = \{Y \in (-\infty, 0)\},
</span>
</li>
<li>Unions: <span class="math display">
A_7 = A_1 \cup A_6 = \{Y=0\} \cup \{Y&lt; 0\} = \{Y \leq 0\}
</span>
</li>
<li>Intersections: <span class="math display">
A_8 = A_4 \cap A_5 = \{Y \geq 0\} \cap \{ -1 \leq Y &lt; 1 \} = \{ 0 \leq Y &lt; 1 \}
</span>
</li>
<li>Iterations of it: <span class="math display">
  A_9 = A_1 \cup A_2 \cup A_3 \cup A_5 \cup A_6 \cup A_7 \cup A_8 = \{ Y \in (-\infty, 1] \cup \{2.5\}\},
</span>
</li>
<li>Certain event: <span class="math display">
A_{10} = A_9 \cup A_9^c = \{Y \in (-\infty, \infty)\} = \{Y \in \mathbb R\}
</span>
</li>
<li>Empty event: <span class="math display">
A_{11} = A_{10}^c = \{ Y \notin \mathbb R \} = \{ \}
</span>
</li>
</ul>
<p>You may verify that <span class="math inline">P(A_1) = 0.5</span>, <span class="math inline">P(A_2) = 0.5</span>, <span class="math inline">P(A_3) = 0</span>, <span class="math inline">P(A_4) = 1</span> <span class="math inline">P(A_5) = 0.5</span>, <span class="math inline">P(A_6) = 0</span>, <span class="math inline">P(A_7) = 0.5</span>, <span class="math inline">P(A_8) = 0.5</span>, <span class="math inline">P(A_9) = 1</span>, <span class="math inline">P(A_{10}) = 1</span>, <span class="math inline">P(A_{11}) = 0</span> for the coin toss experiment.</p>
</section><section id="probability-function" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="probability-function">
<span class="header-section-number">5.4</span> Probability function</h2>
<p>The probability function <span class="math inline">P</span> assigns probabilities to events. The set of all events for which probabilities can be assigned is called the Borel sigma-algebra, denoted as <span class="math inline">\mathcal B</span>.</p>
<p>The previously mentioned events <span class="math inline">A_1, \ldots, A_{11}</span> are elements of <span class="math inline">\mathcal B</span>. Any event of the form <span class="math inline">\{ Y \in (a,b) \}</span> with <span class="math inline">a, b \in \mathbb{R}</span> is also in <span class="math inline">\mathcal B</span>. Moreover, <span class="math inline">\mathcal B</span> includes all possible unions, intersections, and complements of these events. Essentially, it represents the complete collection of events for which we would ever compute probabilities in practice.</p>
<p>A probability function <span class="math inline">P</span> must satisfy certain fundamental rules (axioms) to ensure a well-defined probability framework:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Basic rules of probability</strong></p>
<ul>
<li>
<span class="math inline">P(A) \geq 0</span> for any event <span class="math inline">A</span>
</li>
<li>
<span class="math inline">P(Y \in \mathbb R) = 1</span> for the certain event</li>
<li>
<span class="math inline">P(A \cup B) = P(A) + P(B)</span> &nbsp;if <span class="math inline">A</span> and <span class="math inline">B</span> are disjoint</li>
<li>
<span class="math inline">P(Y \notin \mathbb R) = 0</span> for the empty event</li>
<li>
<span class="math inline">0 \leq P(A) \leq 1</span> &nbsp;for any event <span class="math inline">A</span>
</li>
<li>
<span class="math inline">P(A) \leq P(B)</span> &nbsp;if <span class="math inline">A</span> is a subset of <span class="math inline">B</span>
</li>
<li>
<span class="math inline">P(A^c) = 1 - P(A)</span> &nbsp;for the complement event of <span class="math inline">A</span>
</li>
<li>
<span class="math inline">P(A \cup B) = P(A) + P(B) - P(A \cap B)</span> &nbsp;for any events <span class="math inline">A, B</span>
</li>
</ul>
</div>
<p><br></p>
<p>Two events <span class="math inline">A</span> and <span class="math inline">B</span> are <strong>disjoint</strong> if <span class="math inline">A \cap B = \{\}</span>, meaning they have no common outcomes. For instance, <span class="math inline">A_1 = \{Y=0\}</span> and <span class="math inline">A_2 = \{Y=1\}</span> are disjoint. However, <span class="math inline">A_1</span> and <span class="math inline">A_4 = \{Y \geq 0\}</span> are not disjoint because their intersection, <span class="math inline">A_1 \cap A_4 = \{Y=0\}</span>, is nonempty.</p>
<p>The first three properties listed above are known as the axioms of probability. The remaining properties follow as logical consequences of these axioms.</p>
</section><section id="distribution-function" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="distribution-function">
<span class="header-section-number">5.5</span> Distribution function</h2>
<p>Assigning probabilities to events is straightforward for binary variables, like coin tosses. For instance, knowing that <span class="math inline">P(Y = 1) = 0.5</span> allows us to derive the probabilities for all events in <span class="math inline">\mathcal B</span>. However, for more complex variables, such as <em>education</em> or <em>wage</em>, defining probabilities for all possible events becomes more challenging due to the vast number of potential set operations involved.</p>
<p>Fortunately, it turns out that knowing the probabilities of events of the form <span class="math inline">\{Y \leq a\}</span> is enough to determine the probabilities of all other events. These probabilities are summarized in the cumulative distribution function.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Cumulative distribution function (CDF)</strong></p>
<p>The cumulative distribution function (CDF) of a random variable <span class="math inline">Y</span> is <span class="math display">
  F(a) := P(Y \leq a), \quad a \in \mathbb R.
</span></p>
</div>
<p><br></p>
<p>The CDF is sometimes simply referred to as the <strong>distribution function</strong>, or the <strong>distribution</strong>.</p>
<p>The cumulative distribution function (CDF) of the variable <em>coin</em> is <span class="math display">
        F(a) = \begin{cases} 0 &amp; a &lt; 0, \\
        0.5 &amp; 0 \leq a &lt; 1, \\
        1 &amp; a \geq 1, \end{cases}
    </span> with the following CDF plot:</p>
<div id="fig-CDFcoin" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFcoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex1CDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFcoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: CDF of coin
</figcaption></figure>
</div>
<p>The CDF of the variable <em>education</em> could be</p>
<div id="fig-CDFedu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex3CDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: CDF of education
</figcaption></figure>
</div>
<p>and the CDF of the variable <em>wage</em> may have the following form:</p>
<div id="fig-CDFwage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4CDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CDFwage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: CDF of wage
</figcaption></figure>
</div>
<p>The CDF of a <strong>continuous random variable</strong> is smooth, while the CDF of a <strong>discrete random variable</strong> contains jumps and is flat between jumps. For example, variables like <em>coin</em> and <em>education</em> are discrete, whereas <em>wage</em> is continuous.</p>
<p>Any function <span class="math inline">F(a)</span> with the following properties defines a valid probability distribution:</p>
<ul>
<li>Non-decreasing: <span class="math inline">F(a) \leq F(b)</span> for <span class="math inline">a \leq b</span>;</li>
<li>Limits at 0 and 1: <span class="math inline">\displaystyle \lim_{a \to -\infty} F(a) = 0</span> and <span class="math inline">\displaystyle \lim_{a \to \infty} F(a) = 1</span>
</li>
<li>Right-continuity: <span class="math inline">\displaystyle \lim_{\varepsilon \to 0, \varepsilon \geq 0} F(a + \varepsilon) = F(a)</span>
</li>
</ul>
<p>Right-continuity ensures that cumulative probabilities include the probability at each point, which is especially important for discrete variables with their jump points.</p>
<p>The right-continuity property means that the CDF includes the probability mass at each point <span class="math inline">a</span>, ensuring <span class="math inline">P(Y \leq a)</span> includes <span class="math inline">P(Y = a)</span>. This property is particularly important for discrete random variables where there are jumps in the CDF.</p>
<p>By the basic rules of probability, we can compute the probability of any event of interest if we know the probabilities of all events of the forms <span class="math inline">\{Y \leq a\}</span> and <span class="math inline">\{Y = a \}</span>.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>Some basic rules for the CDF (for <span class="math inline">a &lt; b</span>):</p>
<ul>
<li><span class="math inline">P(Y \leq a) = F(a)</span></li>
<li><span class="math inline">P(Y &gt; a) = 1 - F(a)</span></li>
<li><span class="math inline">P(Y &lt; a) = F(a) - P(Y=a)</span></li>
<li><span class="math inline">P(Y \geq a) = 1 - P(Y &lt; a)</span></li>
<li><span class="math inline">P(a &lt; Y \leq b) = F(b) - F(a)</span></li>
<li><span class="math inline">P(a &lt; Y &lt; b) = F(b) - F(a) - P(Y=b)</span></li>
<li><span class="math inline">P(a \leq Y \leq b) = F(b) - F(a) + P(Y=a)</span></li>
<li><span class="math inline">P(a \leq Y &lt; b) = P(a \leq Y \leq b) - P(Y=b)</span></li>
</ul>
</div>
<p><br></p>
<p>A probability of the form <span class="math inline">P(Y=a)</span>, which involves only an elementary event, is called a <strong>point probability</strong>.</p>
</section><section id="probability-mass-function" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="probability-mass-function">
<span class="header-section-number">5.6</span> Probability mass function</h2>
<p>The <strong>point probability</strong> <span class="math inline">P(Y = a)</span> represents the size of the jump at <span class="math inline">a \in \mathbb{R}</span> in the CDF <span class="math inline">F(a)</span>: <span class="math display">
  P(Y=a) = F(a) - \lim_{\epsilon \to 0, \varepsilon \geq 0} F(a-\varepsilon),
</span> which is the jump height at <span class="math inline">a</span>. We summarize the CDF jump heights or point probabilities in the probability mass function:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Probability mass function (PMF)</strong></p>
<p>The probability mass function (PMF) of a random variable <span class="math inline">Y</span> is <span class="math display">
  \pi(a) := P(Y = a), \quad a \in \mathbb R
</span></p>
</div>
<p><br></p>
<p>The PMF of the <em>coin</em> variable is <span class="math display">
  \pi(a) = P(Y=a) = \begin{cases} 0.5 &amp; \text{if} \ a \in\{0,1\}, \\
  0 &amp; \text{otherwise}. \end{cases}
</span> The <em>education</em> variable may have the following PMF: <span class="math display">
        \pi(a) = P(Y=a) = \begin{cases}
        0.008 &amp; \text{if} \ a = 4 \\
        0.048 &amp; \text{if} \ a = 10 \\
        0.392 &amp; \text{if} \ a = 12 \\
        0.072 &amp; \text{if} \ a = 13 \\
        0.155 &amp; \text{if} \ a = 14 \\
        0.071 &amp; \text{if} \ a = 16 \\
        0.225 &amp; \text{if} \ a = 18 \\
        0.029 &amp; \text{if} \ a = 21 \\
        0   &amp; \text{otherwise}
        \end{cases}
  </span></p>
<div id="fig-condCDFCoin" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condCDFCoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-condCDFCoin" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-CDFedu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-CDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex3CDF.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-condCDFCoin">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-CDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) CDF of education
</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-condCDFCoin" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-PMFedu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-PMFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex3PMF.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-condCDFCoin">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-PMFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) PMF of education
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-condCDFCoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4
</figcaption></figure>
</div>
<p>Because continuous variables have no jumps in their CDF, the PMF concept makes only sense for discrete random variables.</p>
</section><section id="probability-density-function" class="level2" data-number="5.7"><h2 data-number="5.7" class="anchored" data-anchor-id="probability-density-function">
<span class="header-section-number">5.7</span> Probability density function</h2>
<p>For continuous random variables, the CDF has no jumps, meaning the probability of any specific value is zero, and probability is distributed continuously over intervals. Unlike discrete random variables, which are characterized by both the PMF and the CDF, continuous variables do not have a positive PMF. Instead, they are described by the probability density function (PDF), which serves as the continuous analogue. If the CDF is differentiable, the PDF is given by its derivative:</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Probability density function</strong></p>
<p>The <strong>probability density function (PDF)</strong> or simply <strong>density function</strong> of a continuous random variable <span class="math inline">Y</span> is the derivative of its CDF: <span class="math display">
    f(a) = \frac{d}{da} F(a).
</span> Conversely, the CDF can be obtained from the PDF by integration: <span class="math display">
    F(a) = \int_{-\infty}^a f(u) \ \text{d}u
</span></p>
</div>
<p><br></p>
<p>Any function <span class="math inline">f(a)</span> with the following properties defines a valid probability density function:</p>
<ul>
<li>Non-negativity: <span class="math inline">f(a) \geq 0</span> for all <span class="math inline">a \in \mathbb R</span>;</li>
<li>Normalization: <span class="math inline">\int_{-\infty}^\infty f(u) \ \text{d}u = 1</span>.</li>
</ul>
<div id="fig-CDFwage2" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-CDFwage2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-CDFwage2" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-CDFwag" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-CDFwag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4CDF.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-CDFwage2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-CDFwag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) CDF of wage
</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-CDFwage2" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-PDFwag" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-PDFwag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/sec02-ex4PDF.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-CDFwage2">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-PDFwag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) PDF of wage
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-CDFwage2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5
</figcaption></figure>
</div>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p>Basic rules for <strong>continuous random variables</strong> (with <span class="math inline">a \leq  b</span>):</p>
<ul>
<li><span class="math inline">\displaystyle P(Y = a) = \int_a^a f(u) \ \text{d}u = 0</span></li>
<li><span class="math inline">\displaystyle P(Y \leq a) = P(Y &lt; a) = F(a) = \int_{-\infty}^a f(u) \ \text{d}u</span></li>
<li><span class="math inline">\displaystyle P(Y &gt; a) = P(Y \geq a) = 1 - F(a) = \int_a^\infty f(u) \ \text{d}u</span></li>
<li><span class="math inline">\displaystyle P(a &lt; Y &lt; b) = F(b) - F(a) = \int_a^b f(u) \ \text{d}u</span></li>
<li><span class="math inline">\displaystyle P(a &lt; Y &lt; b) = P(a &lt; Y \leq b) = P(a \leq Y \leq b) = P(a \leq Y &lt; b)</span></li>
</ul>
</div>
<p><br></p>
</section><section id="conditional-distribution" class="level2" data-number="5.8"><h2 data-number="5.8" class="anchored" data-anchor-id="conditional-distribution">
<span class="header-section-number">5.8</span> Conditional distribution</h2>
<p>The distribution of <em>wage</em> may differ between men and women. Similarly, the distribution of <em>education</em> may vary between married and unmarried individuals. In contrast, the distribution of a <em>coin flip</em> should remain the same regardless of whether the person tossing the coin earns 15 or 20 EUR per hour.</p>
<p>The <strong>conditional cumulative distribution function</strong> (conditional CDF), <span class="math display">F_{Y|Z=b}(a) = F_{Y|Z}(a|b) = P(Y\leq a|Z=b),</span> represents the distribution of a random variable <span class="math inline">Y</span> given that another random variable <span class="math inline">Z</span> takes a specific value <span class="math inline">b</span>. It answers the question: “If we know that <span class="math inline">Z=b</span>, what is the distribution of <span class="math inline">Y</span>?”</p>
<p>For example, suppose that <span class="math inline">Y</span> represents <em>wage</em> and <span class="math inline">Z</span> represents <em>education</em></p>
<ul>
<li>
<span class="math inline">F_{Y|Z=12}(a)</span> is the CDF of wages among individuals with 12 years of education.</li>
<li>
<span class="math inline">F_{Y|Z=14}(a)</span> is the CDF of wages among individuals with 14 years of education.</li>
<li>
<span class="math inline">F_{Y|Z=18}(a)</span> is the CDF of wages among individuals with 18 years of education.</li>
</ul>
<p>Since <em>wage</em> is a continuous variable, its conditional distribution given any specific value of another variable is also continuous. The conditional density of <span class="math inline">Y</span> given <span class="math inline">Z=b</span> is defined as the derivative of the conditional CDF: <span class="math display">
        f_{Y|Z=b}(a) = f_{Y|Z}(a|b) = \frac{d}{d a} F_{Y|Z=b}(a).
</span></p>
<div id="fig-condCDFWageEdu" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condCDFWageEdu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-condCDFWageEdu" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-cCDFedu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-cCDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/WageEduCondCDF.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-condCDFWageEdu">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cCDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Conditional CDFs of wage given education
</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-condCDFWageEdu" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-cPDFedu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-cPDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/WageEduCondPDF.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-condCDFWageEdu">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cPDFedu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Conditional PDFs of wage given education
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-condCDFWageEdu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6
</figcaption></figure>
</div>
<p>We observe that the distribution of wage varies across different levels of education. For example, individuals with fewer years of education are more likely to earn less than 20 EUR per hour: <span class="math display">
P(Y\leq 20 | Z=12) = F_{Y|Z=12}(20) &gt; F_{Y|Z=18}(20) = P(Y\leq 20|Z = 18).
</span> Because the conditional distribution of <span class="math inline">Y</span> given <span class="math inline">Z=b</span> depends on the value of <span class="math inline">Z=b</span> we say that the random variables <span class="math inline">Y</span> and <span class="math inline">Z</span> are <strong>dependent random variables</strong>.</p>
<p>Note that the conditional CDF <span class="math inline">F_{Y|Z=b}(a)</span> can only be defined for events <span class="math inline">Z=b</span> that are possible, i.e.&nbsp;<span class="math inline">b</span> must be in the support of <span class="math inline">Z</span>. <!-- The support of $Y$ is the set of all possible values that $Y$ can take. --> Formally, the support consists of all <span class="math inline">b \in \mathbb R</span> where the cumulative distribution function <span class="math inline">F_Z(b)</span> is not flat – meaning it either increases continuously or has a jump. For instance, the support of the variable <em>education</em> is <span class="math inline">\{4, 10, 12, 13, 14, 16, 18, 21\}</span> and the support of the variable <em>wage</em> is <span class="math inline">\{a \in \mathbb R: a \geq 0\}</span>.</p>
<p>We can also condition on more than one variable. Let <span class="math inline">Z_1</span> represent the labor market <em>experience</em> in years and <span class="math inline">Z_2</span> be the <em>female</em> dummy variable. The conditional CDF of <span class="math inline">Y</span> given <span class="math inline">Z_1 = b</span> and <span class="math inline">Z_2 = c</span> is: <span class="math display">
F_{Y|Z_1=b,Z_2=c}(a) = F_{Y|Z_1,Z_2}(a|b,c) = P(Y \leq a|Z_1=b, Z_2=c).
</span></p>
<p>For example:</p>
<ul>
<li>
<span class="math inline">F_{Y|Z_1=10,Z_2=1}(a)</span> is the CDF of wages among women with 10 years of experience.</li>
<li>
<span class="math inline">F_{Y|Z_1=10,Z_2=0}(a)</span> is the CDF of wages among men with 10 years of experience.</li>
</ul>
<div id="fig-condCDFWageExpFem" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condCDFWageExpFem-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-condCDFWageExpFem" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-cCDFwag" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-cCDFwag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/WageExFemCondCDF.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-condCDFWageExpFem">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cCDFwag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Conditional CDFs
</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-condCDFWageExpFem" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-cPDFwag" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-cPDFwag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/WageExFemCondPDF.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-condCDFWageExpFem">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cPDFwag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Conditional PDFs
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-condCDFWageExpFem-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.7: Conditional CDFs and PDFs of wage given experience and gender
</figcaption></figure>
</div>
<!-- ::: {#fig-condCDFWageExpFem} -->
<!-- ![](./img/WageExFemCondCDF.png){width=50%} -->
<!-- Conditional CDFs of wage given experience and gender -->
<!-- ::: -->
<p>Clearly the random variable <span class="math inline">Y</span> and the random vector <span class="math inline">(Z_1, Z_2)</span> are dependent.</p>
<p>More generally, we can condition on the event that a <span class="math inline">k</span>-variate random vector <span class="math inline">\boldsymbol Z = (Z_1, \ldots, Z_k)'</span> takes the value <span class="math inline">\{\boldsymbol Z = \boldsymbol b\}</span>, i.e.&nbsp;<span class="math inline">\{Z_1 = b_1, \ldots, Z_k = b_k\}</span>. The conditional CDF of <span class="math inline">Y</span> given <span class="math inline">\{\boldsymbol Z = \boldsymbol b\}</span> is <span class="math display">
  F_{Y|\boldsymbol Z = \boldsymbol b}(a) = F_{Y|Z_1 = b_1, \ldots, Z_k = b_k}(a).
</span></p>
<p>The variable of interest, <span class="math inline">Y</span>, can also be discrete. Then, any conditional CDF of <span class="math inline">Y</span> is also discrete. Below is the conditional CDF of <em>education</em> given the <em>married</em> dummy variable:</p>
<ul>
<li>
<span class="math inline">F_{Y|Z=0}(a)</span> is the CDF of education among unmarried individuals.</li>
<li>
<span class="math inline">F_{Y|Z=1}(a)</span> is the CDF of education among married individuals.</li>
</ul>
<div id="fig-condCDFEduMarr" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condCDFEduMarr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/EduMarrCondCDF.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-condCDFEduMarr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.8: Conditional CDFs of education given married
</figcaption></figure>
</div>
<p>The conditional PMFs <span class="math inline">\pi_{Y|Z=0}(a) = P(Y = a | Z=0)</span> and <span class="math inline">\pi_{Y|Z=1}(a)= P(Y = a | Z=1)</span> indicate the jump heights of <span class="math inline">F_{Y|Z=0}(a)</span> and <span class="math inline">F_{Y|Z=1}(a)</span> at <span class="math inline">a</span>.</p>
<div id="fig-condCDFEduMarr" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condCDFEduMarr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/EduMarrCondPMF_SideBySide.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-condCDFEduMarr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.9: Conditional PMFs of education given married
</figcaption></figure>
</div>
<p>Clearly, <em>education</em> and <em>married</em> are dependent random variables. E.g., <span class="math inline">\pi_{Y|Z=0}(12) &gt; \pi_{Y|Z=1}(12)</span> and <span class="math inline">\pi_{Y|Z=0}(18) &lt; \pi_{Y|Z=1}(18)</span>.</p>
<p>In contrast, consider <span class="math inline">Y=</span> coin flip and <span class="math inline">Z=</span> married dummy variable. The CDF of a coin flip should be the same for married or unmarried individuals:</p>
<div id="fig-condCDFCoin" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-condCDFCoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-condCDFCoin" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-married" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-married-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/condCDFcoin0.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-condCDFCoin">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-married-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Coin flip given married
</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-condCDFCoin" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-unmarried" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-unmarried-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./img/condCDFcoin1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-condCDFCoin">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-unmarried-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Coin flip given unmarried
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-condCDFCoin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.10: Conditional CDFs of a coin flip of a married (left) and unmarried (right) individual
</figcaption></figure>
</div>
<p>Because <span class="math display">
  F_Y(a) = F_{Y|Z=0}(a) = F_{Y|Z=1}(a) \quad \text{for all} \ a
</span> we say that <span class="math inline">Y</span> and <span class="math inline">Z</span> are <strong>independent random variables</strong>.</p>
</section><section id="independence-of-random-variables" class="level2" data-number="5.9"><h2 data-number="5.9" class="anchored" data-anchor-id="independence-of-random-variables">
<span class="header-section-number">5.9</span> Independence of random variables</h2>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Independence</strong></p>
<p><span class="math inline">Y</span> and <span class="math inline">Z</span> are <strong>independent</strong> if and only if <span class="math display">
  F_{Y|Z=b}(a) = F_{Y}(a) \quad \text{for all} \ a \quad \text{and for almost every} \ b.
</span></p>
</div>
<p><br></p>
<p>Note that if <span class="math inline">F_{Y|Z=b}(a) = F_{Y}(a)</span> for all <span class="math inline">b</span>, then automatically <span class="math inline">F_{Z|Y=a}(b) = F_{Y}(b)</span> for all <span class="math inline">a</span>. Due to this symmetry we can equivalently define independence through the property <span class="math inline">F_{Z|Y=a}(b) = F_{Z}(b)</span>.</p>
<p>Here, “for almost every <span class="math inline">b</span>” means for every <span class="math inline">b</span> in the support of Z, apart from a set of values that has probability <span class="math inline">0</span> under <span class="math inline">Z</span>. Put differently, the condition must hold for all <span class="math inline">b</span>-values that <span class="math inline">Z</span> can actually take, with exceptions allowed only on a set whose probability is <span class="math inline">0</span>. Think of it as “for all practical purposes”. The condition must hold for all values <span class="math inline">b</span> that could realistically occur. For instance, we only need independence to hold for non-negative wages. We don’t need to check independence for negative wages since they can’t occur.</p>
<p>The definition naturally generalizes to <span class="math inline">Z_1, Z_2, Z_3</span>. They are <strong>mutually independent</strong> if, for each <span class="math inline">i \in \{1,2,3\}</span>, the conditional distribution of <span class="math inline">Z_i</span> given the other two equals its marginal distribution. In CDF form, this means:</p>
<ol type="i">
<li><span class="math inline">F_{Z_1|Z_2=b_2, Z_3=b_3}(a) = F_{Z_1}(a)</span></li>
<li><span class="math inline">F_{Z_2|Z_1=b_1, Z_3=b_3}(a) = F_{Z_2}(a)</span></li>
<li><span class="math inline">F_{Z_3|Z_1=b_1, Z_2=b_2}(a) = F_{Z_3}(a)</span></li>
</ol>
<p>for all <span class="math inline">a</span> and for almost every <span class="math inline">(b_1, b_2, b_3)</span>. Here, we need all three conditions.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Mutual independence</strong></p>
<p>The random variables <span class="math inline">Z_1, \ldots, Z_n</span> are <strong>mutually independent</strong> if and only if, for each <span class="math inline">i = 1,\dots,n</span>, <span class="math display">
  F_{Z_i | Z_1=b_1,\ldots,Z_{i-1}=b_{i-1},\,Z_{i+1}=b_{i+1},\ldots,Z_n=b_n}(a)
=
F_{Z_i}(a).
</span> for all <span class="math inline">a</span> and almost every <span class="math inline">(b_1, \ldots, b_n)</span>.</p>
</div>
<p><br></p>
<p>An equivalent viewpoint uses the <strong>joint CDF</strong> of the vector <span class="math inline">\boldsymbol Z = (Z_1, \ldots, Z_n)'</span>, which is defined as: <span class="math display">
  F_{\boldsymbol Z}(\boldsymbol a) = F_{Z_1, \ldots, Z_n}(a_1, \ldots, a_n) = P(Z_1 \leq a_1, \ldots, Z_n \leq a_n) = P(\boldsymbol Z \leq \boldsymbol a),
</span> where <span class="math display">
P(Z_1 \leq a_1, \ldots, Z_n \leq a_n) = P(\{Z_1 \leq a_1\} \cap \ldots \cap \{Z_n \leq a_n\}).
</span> Then <span class="math inline">Z_1, \ldots, Z_n</span> are mutually independent if and only if the joint CDF is the product of the marginal CDFs: <span class="math display">
  F_{\boldsymbol Z}(\boldsymbol a) = F_{Z_1}(a_1) \cdots F_{Z_n}(a_n) \quad \text{for all} \ a_1, \ldots, a_n.
</span></p>
</section><section id="independence-of-random-vectors" class="level2" data-number="5.10"><h2 data-number="5.10" class="anchored" data-anchor-id="independence-of-random-vectors">
<span class="header-section-number">5.10</span> Independence of random vectors</h2>
<p>Often in practice, we work with multiple variables recorded for different individuals or time points. For example, consider two random vectors: <span class="math display">
  \boldsymbol{X}_1 = (X_{11}, \ldots, X_{1k})',
  \quad
  \boldsymbol{X}_2 = (X_{21}, \ldots, X_{2k})'.
</span> The conditional distribution function of <span class="math inline">\boldsymbol{X}_1</span> given that <span class="math inline">\boldsymbol{X}_2</span> takes the value <span class="math inline">\boldsymbol{b}=(b_1,\ldots,b_k)'</span> is <span class="math display">
  F_{\boldsymbol{X}_1 | \boldsymbol{X}_2 = \boldsymbol{b}}(\boldsymbol{a})
  =
  P(\boldsymbol{X}_1 \le \boldsymbol{a}|\boldsymbol{X}_2 = \boldsymbol{b}),
</span> where <span class="math inline">\boldsymbol{X}_1 \le \boldsymbol{a}</span> means <span class="math inline">X_{1j} \le a_j</span> for each coordinate <span class="math inline">j=1,\ldots,k</span>.</p>
<p>For instance, if <span class="math inline">\boldsymbol{X}_1</span> and <span class="math inline">\boldsymbol{X}_2</span> represent the survey answers of two different, randomly chosen people, then <span class="math inline">F_{\boldsymbol{X}_2 | \boldsymbol{X}_1=\boldsymbol{b}}(\boldsymbol{a})</span> describes the distribution of the second person’s answers, given that the first person’s answers are <span class="math inline">\boldsymbol{b}</span>. If the two people are truly randomly selected and unrelated to one another, we would not expect <span class="math inline">\boldsymbol{X}_2</span> to depend on whether <span class="math inline">\boldsymbol{X}_1</span> equals <span class="math inline">\boldsymbol{b}</span> or some other value <span class="math inline">\boldsymbol{c}</span>. In other words, knowing <span class="math inline">\boldsymbol X_1</span> provides no information that changes the distribution of <span class="math inline">\boldsymbol X_2</span>.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>Independence of random vectors</strong></p>
<p>Two random vectors <span class="math inline">\boldsymbol{X}_1</span> and <span class="math inline">\boldsymbol{X}_2</span> are <strong>independent</strong> if and only if <span class="math display">
F_{\boldsymbol{X}_1 | \boldsymbol{X}_2 = \boldsymbol{b}}(\boldsymbol{a})
=
F_{\boldsymbol{X}_1}(\boldsymbol{a})
\quad
\text{for all } \boldsymbol{a}
\quad
\text{and for almost every } \boldsymbol{b}.
</span></p>
</div>
<p><br></p>
<p>This definition extends naturally to mutual independence of <span class="math inline">n</span> random vectors <span class="math inline">\boldsymbol{X}_1,\dots,\boldsymbol{X}_n</span>, where <span class="math inline">\boldsymbol{X}_i = (X_{i1},\dots,X_{ik})'</span>. They are called <strong>mutually independent</strong> if, for each <span class="math inline">i = 1,\dots,n</span>, <span class="math display">
  F_{\boldsymbol X_i| \boldsymbol X_1=\boldsymbol b_1, \ldots, \boldsymbol X_{i-1}=\boldsymbol b_{i-1}, \boldsymbol X_{i+1}=\boldsymbol b_{i+1}, \ldots, \boldsymbol X_n = \boldsymbol b_n}(\boldsymbol a) = F_{\boldsymbol X_i}(\boldsymbol a)
</span> for all <span class="math inline">\boldsymbol{a}</span> and almost every <span class="math inline">(\boldsymbol{b}_1,\dots,\boldsymbol{b}_n)</span>.</p>
<p>Hence, in an independent sample, what the <span class="math inline">i</span>-th randomly chosen person answers does not depend on anyone else’s answers.</p>
<div style="border: 1px solid black; background-color:#f2f2f2; padding: 10px;">
<p><strong>i.i.d. sample / random sample</strong></p>
<p>A collection of random vectors <span class="math inline">\boldsymbol{X}_1, \dots, \boldsymbol{X}_n</span> is <strong>i.i.d.</strong> (independent and identically distributed) if they are mutually independent and have the same distribution function <span class="math inline">F</span>. Formally, <span class="math display">
  F_{\boldsymbol X_i| \boldsymbol X_1=\boldsymbol b_1, \ldots, \boldsymbol X_{i-1}=\boldsymbol b_{i-1}, \boldsymbol X_{i+1}=\boldsymbol b_{i+1}, \ldots, \boldsymbol X_n = \boldsymbol b_n}(\boldsymbol a) = F(\boldsymbol a)
</span> for all <span class="math inline">i=1, \ldots, n</span>, for all <span class="math inline">\boldsymbol{a}</span>, and almost all <span class="math inline">(\boldsymbol{b}_1,\dots,\boldsymbol{b}_n)</span>.</p>
<p>An <strong>i.i.d. dataset</strong> (or <strong>random sample</strong>) is one where each observation not only comes from the same population distribution <span class="math inline">F</span> but is independent of the others. The function <span class="math inline">F</span> is called the <strong>population distribution</strong> or the <strong>data-generating process (DGP)</strong>.</p>
</div>
<p><br></p>
<p>The CPS data are <strong>cross-sectional</strong> data: <span class="math inline">n</span> individuals are randomly selected from the U.S. population and independently interviewed on <span class="math inline">k</span> variables. Consequently, these <span class="math inline">n</span> observations form an i.i.d. sample.</p>
<p>If <span class="math inline">Y_1, \ldots, Y_n</span> are i.i.d., then <span class="math inline">\log(Y_1), \ldots, \log(Y_n)</span> are also i.i.d. In fact, any identical transformation of each observation preserves the independence and identical distribution. More formally, if <span class="math inline">\boldsymbol X_1, \ldots, \boldsymbol X_n</span> is i.i.d., then <span class="math inline">g(\boldsymbol X_1), \ldots, g(\boldsymbol X_n)</span> is i.i.d. as well, for any function <span class="math inline">g(\cdot)</span>. For instance, if the wages of <span class="math inline">n</span> interviewed individuals are i.i.d., then their log-wages are also i.i.d.</p>
<p>Sampling methods of obtaining economic datasets that may be considered as random sampling are:</p>
<ul>
<li>
<strong>Survey sampling</strong><br>
Examples: representative survey of randomly selected households from a list of residential addresses; online questionnaire to a random sample of recent customers</li>
<li>
<strong>Administrative records</strong><br>
Examples: data from a government agency database, Statistisches Bundesamt, ECB, etc.</li>
<li>
<strong>Direct observation</strong><br>
Collected data without experimental control and interactions with the subject. Example: monitoring customer behavior in a retail store</li>
<li>
<strong>Web scraping</strong><br>
Examples: collected house prices on real estate sites or hotel/electronics prices on booking.com/amazon, etc.</li>
<li>
<strong>Field experiment</strong><br>
To study the impact of a treatment or intervention on a treatment group compared with a control group. Example: testing the effectiveness of a new teaching method by implementing it in a selected group of schools and comparing results to other schools with traditional methods</li>
<li>
<strong>Laboratory experiment</strong><br>
Example: a controlled medical trial for a new drug</li>
</ul>
<p>Examples of cross-sectional data sampling that may produce some dependence across observations are:</p>
<ul>
<li><p><strong>Stratified sampling</strong><br>
The population is first divided into homogenous subpopulations (strata), and a random sample is obtained from each stratum independently. Examples: divide companies into industry strata (manufacturing, technology, agriculture, etc.) and sample from each stratum; divide the population into income strata (low-income, middle-income, high-income).<br>
The sample is independent within each stratum, but it is not between different strata. The strata are defined based on specific characteristics that may be correlated with the variables collected in the sample.</p></li>
<li><p><strong>Clustered sampling</strong><br>
Entire subpopulations are drawn. Example: new teaching methods are compared to traditional ones on the student level, where only certain classrooms are randomly selected, and all students in the selected classes are evaluated.<br>
Within each cluster (classroom), the sample is dependent because of the shared environment and teacher’s performance, but between classrooms, it is independent.</p></li>
</ul>
<p>Other types of data we often encounter in econometrics are time series data, panel data, or spatial data:</p>
<ul>
<li><p><strong>Time series data</strong> consists of observations collected at different points in time, such as stock prices, daily temperature measurements, or GDP figures. These observations are ordered and typically show temporal trends, seasonality, and autocorrelation.</p></li>
<li><p><strong>Panel data</strong> involves observations collected on multiple entities (e.g., individuals, firms, countries) over multiple time periods. Every entity thus forms a cluster, within which there is a time series of observations. In this sense, panel data is a specific form of clustered sampling.</p></li>
<li><p><strong>Spatial data</strong> includes observations taken at different geographic locations, where values at nearby locations are often correlated.</p></li>
</ul>
<p>Time series, panel, and spatial data cannot be considered a random sample given their temporal or geographic dependence.</p>
</section><section id="r-codes" class="level2" data-number="5.11"><h2 data-number="5.11" class="anchored" data-anchor-id="r-codes">
<span class="header-section-number">5.11</span> R-codes</h2>
<p><a href="https://statistics.svenotto.com/statistics-sec04.R">statistics-sec04.R</a></p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./stat1_data.html" class="pagination-link" aria-label="Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat4_expectation.html" class="pagination-link" aria-label="Expectated value">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Expectated value</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>